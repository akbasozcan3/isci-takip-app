import { Ionicons } from '@expo/vector-icons';
import AsyncStorage from '@react-native-async-storage/async-storage';
import { LinearGradient } from 'expo-linear-gradient';
import * as Location from 'expo-location';
import { useFocusEffect, useRouter } from 'expo-router';
import * as SecureStore from 'expo-secure-store';
import React from 'react';
import {
  Animated,
  DeviceEventEmitter,
  Dimensions,
  FlatList,
  Image,
  Linking,
  Modal,
  Platform,
  Pressable,
  RefreshControl,
  StatusBar,
  StyleSheet,
  Text,
  View
} from 'react-native';
import * as Clipboard from 'expo-clipboard';
import { SafeAreaView } from 'react-native-safe-area-context';
import { io, Socket } from 'socket.io-client';
import { AnalyticsCard } from '../../components/AnalyticsCard';
import { Footer } from '../../components/Footer';
import { FullScreenMap } from '../../components/FullScreenMap';
import { NetworkStatusIcon } from '../../components/NetworkStatusIcon';
import { OnboardingModal } from '../../components/OnboardingModal';
import { Toast, useToast } from '../../components/Toast';
import { UnifiedHeader } from '../../components/UnifiedHeader';
import { LoadingState } from '../../components/ui/LoadingState';
import { getApiBase } from '../../utils/api';
import { authFetch, getToken } from '../../utils/auth';
import { shareCurrentLocation } from '../../utils/locationShare';

const { width } = Dimensions.get('window');

const API_BASE = getApiBase();

// --- Types ---
interface DashboardStats {
  activeWorkers: number;
  totalGroups: number;
  todayDistance: number; // km
  activeAlerts: number;
}

interface RecentActivity {
  id: string;
  type: 'location' | 'join' | 'alert' | 'system';
  message: string;
  timestamp: number;
  userId?: string;
}

interface Slide {
  id: string;
  title: string;
  description: string;
  icon: string;
  color: string;
}

interface Article {
  id: string;
  title: string;
  excerpt: string;
  icon?: string;
  readTime: string;
  category?: string;
  tags?: string[];
  createdAt?: string;
  updatedAt?: string;
}

// --- Static content (you can fetch these from API if desired) ---
const SLIDES: Slide[] = [
  {
    id: '1',
    title: 'Gerçek Zamanlı Takip',
    description: 'Ekibinizin konumunu anlık olarak güvenli şekilde takip edin; düşük gecikme, yüksek doğruluk.',
    icon: 'location',
    color: '#06b6d4',
  },
  {
    id: '2',
    title: 'Bavaxe Raporlama',
    description: 'Günlük mesafe, rota ve etkinlik raporlarını kolayca görüntüleyin ve dışa aktarın.',
    icon: 'stats-chart',
    color: '#10b981',
  },
  {
    id: '3',
    title: 'Güvenlik ve Gizlilik',
    description: 'Verileriniz şifreli, erişim kontrolleri güçlü. KVKK ve veri koruma uyumlu.',
    icon: 'shield-checkmark',
    color: '#000000ff',
  },
];

// Articles will be fetched from backend

const QUICK_ACTIONS = [
  { id: 'track', title: 'Canlı Takip', icon: 'navigate-circle', route: '/(tabs)/track', color: '#06b6d4' },
  { id: 'groups', title: 'Gruplarım', icon: 'people-circle', route: '/(tabs)/groups', color: '#7c3aed' },
  { id: 'location-features', title: 'Konum Özellikleri', icon: 'location', route: '/(tabs)/location-features', color: '#10b981' },
  { id: 'analytics', title: 'Analitik', icon: 'stats-chart', route: '/(tabs)/analytics', color: '#8b5cf6' },
  { id: 'admin', title: 'Yönetim', icon: 'shield-checkmark-outline', route: '/(tabs)/admin', color: '#f59e0b' },
  { id: 'settings', title: 'Ayarlar', icon: 'person-outline', route: '/(tabs)/profile', color: '#64748b' },
];
export default function HomeScreen(): React.JSX.Element {
  const router = useRouter();
  const { toast, showError, showSuccess, showWarning, showInfo, hideToast } = useToast();

  const [isAuthenticated, setIsAuthenticated] = React.useState(false);
  const [refreshing, setRefreshing] = React.useState(false);
  const [loading, setLoading] = React.useState(true);
  const [userName, setUserName] = React.useState('Ekip Üyesi');
  const [userId, setUserId] = React.useState('');
  const [stats, setStats] = React.useState<DashboardStats>({ activeWorkers: 0, totalGroups: 0, todayDistance: 0, activeAlerts: 0 });
  const [stepData, setStepData] = React.useState({ steps: 0, goal: null as number | null, progress: 0 });

  const [hasLocationPermission, setHasLocationPermission] = React.useState(false);
  const [hidePermissionBanner, setHidePermissionBanner] = React.useState(true);
  const [permissionChecked, setPermissionChecked] = React.useState(false);
  const [currentSlide, setCurrentSlide] = React.useState(0);
  const [showLightbox, setShowLightbox] = React.useState(false);
  const [lightboxImage, setLightboxImage] = React.useState<string | null>(null);
  const [articles, setArticles] = React.useState<Article[]>([]);
  const [categoryArticles, setCategoryArticles] = React.useState<Record<string, Article[]>>({});
  const [categoryLoading, setCategoryLoading] = React.useState<Record<string, boolean>>({});
  const [showOnboarding, setShowOnboarding] = React.useState(false);
  const [plans, setPlans] = React.useState<any[]>([
    {
      id: 'plus',
      title: 'Plus',
      priceLabel: '$20 / ay',
      monthlyPrice: 20,
      monthlyPriceTRY: 600,
      currency: 'USD',
      badge: 'Popüler',
      recommended: false,
      description: 'Profesyoneller için gelişmiş özellikler',
      features: [
        'Öncelikli destek',
        '5 çalışma alanı',
        'Gerçek zamanlı takip',
        'Gelişmiş raporlama',
        '90 günlük veri saklama',
        '200 istek/dakika',
        '50 aktivite limiti',
        '2000 konum geçmişi'
      ]
    },
    {
      id: 'business',
      title: 'Business',
      priceLabel: '$50 / ay',
      monthlyPrice: 50,
      monthlyPriceTRY: 1500,
      currency: 'USD',
      badge: 'Önerilen',
      recommended: true,
      description: 'Kurumsal düzey güvenlik ve yönetim',
      features: [
        'Sınırsız çalışma alanı',
        'Takım rol yönetimi',
        'Kurumsal güvenlik raporları',
        'Özel müşteri yöneticisi',
        'API erişimi',
        'Sınırsız veri saklama',
        '500 istek/dakika',
        '200 aktivite limiti',
        '10000 konum geçmişi',
        'Sınırsız export'
      ]
    }
  ]);
  const [currentPlanId, setCurrentPlanId] = React.useState<string>('free');
  const socketRef = React.useRef<Socket | null>(null);

  // Animations
  const fadeAnim = React.useRef(new Animated.Value(0)).current;
  const slideX = React.useRef(new Animated.Value(0)).current;
  const cardScale = React.useRef(new Animated.Value(1)).current;
  const lightboxScale = React.useRef(new Animated.Value(0)).current;
  const statsAnimRef = React.useRef(Array(4).fill(0).map(() => new Animated.Value(0)));

  const headerScale = React.useRef(new Animated.Value(0.95)).current;

  // Slider auto-play
  const sliderRef = React.useRef<FlatList>(null);
  const autoPlayRef = React.useRef<ReturnType<typeof setInterval> | null>(null);

  // TÜM HOOKS'LAR ERKEN RETURN'DEN ÖNCE - Fonksiyonlar useCallback ile sarmalanmalı
  // loadDashboardData önce tanımlanmalı çünkü checkAuth tarafından kullanılıyor
  const loadDashboardData = React.useCallback(async (workerIdParam?: string) => {
    try {
      const worker = workerIdParam || userId;
      if (!worker) {
        setLoading(false);
        return;
      }

      // Token al
      let authHeaders: Record<string, string> = {};
      try {
        const t = await getToken();
        if (t) authHeaders['Authorization'] = `Bearer ${t}`;
      } catch (e) {
        console.warn('Token error:', e);
      }

      // Abonelik durumunu kontrol et (plan bazlı limitler için)
      let subscriptionPlan = 'free';
      let activitiesLimit = 10;
      try {
        const subRes = await authFetch('/me/subscription');
        if (subRes.ok) {
          const subData = await subRes.json();
          subscriptionPlan = subData.subscription?.planId || 'free';
          activitiesLimit = subscriptionPlan === 'business' ? 200 : (subscriptionPlan === 'plus' ? 50 : 10);
        }
      } catch (e) {
        console.warn('Subscription check error:', e);
      }

      // Backend'den gerçek veri çek (timeout plan bazlı)
      const timeoutMs = subscriptionPlan === 'business' ? 15000 : (subscriptionPlan === 'plus' ? 12000 : 10000);
      const controller = new AbortController();
      const timeoutId = setTimeout(() => controller.abort(), timeoutMs);

      try {
        const [statsRes, stepsRes] = await Promise.all([
          authFetch(`/dashboard/${worker}`, {
            signal: controller.signal
          }).catch(() => ({ ok: false, status: 404, json: async () => ({}) } as Response)),
          authFetch(`/steps/today`, {
            signal: controller.signal
          }).catch(() => ({ ok: false, status: 404, json: async () => ({ success: false, data: {} }) } as Response)),
        ]);

        clearTimeout(timeoutId);

        // Stats güncelle
        if (statsRes.ok) {
          const response = await statsRes.json();
          // Backend ResponseFormatter kullanıyor: { success: true, data: {...} }
          const data = response.success && response.data ? response.data : response;
          setStats({
            activeWorkers: data.activeWorkers || 0,
            totalGroups: data.totalGroups || 0,
            todayDistance: data.todayDistance || 0,
            activeAlerts: data.activeAlerts || 0,
          });
          console.log('Dashboard stats loaded:', data);
          if (data.cached) {
            console.log('[Performance] Using cached dashboard data');
          }
        } else {
          if (statsRes.status !== 429) {
            console.warn('Stats fetch failed:', statsRes.status);
          }
          setStats({ activeWorkers: 0, totalGroups: 0, todayDistance: 0, activeAlerts: 0 });
        }

        // Activities removed from UI — skip fetching/processing here.

        // Steps güncelle
        if (stepsRes.ok) {
          const stepsData = await stepsRes.json();
          if (stepsData.success && stepsData.data) {
            const steps = stepsData.data.steps || 0;
            const goal = stepsData.data.goal || null;
            const progress = goal && goal > 0 ? Math.min(steps / goal, 1) : 0;
            setStepData({ steps, goal, progress });
          }
        }
      } catch (e: unknown) {
        clearTimeout(timeoutId);
        if (e instanceof Error && e.name !== 'AbortError') {
          console.error('Dashboard load error:', e);
        }
        // Fallback - backend yoksa bile çalışsın
        setStats({ activeWorkers: 0, totalGroups: 0, todayDistance: 0, activeAlerts: 0 });
      } finally {
        setLoading(false);
      }
    } catch (e) {
      console.error('Dashboard outer error:', e);
      setStats({ activeWorkers: 0, totalGroups: 0, todayDistance: 0, activeAlerts: 0 });
      setLoading(false);
    }
  }, [userId]);

  // checkAuth loadDashboardData'yı kullandığı için loadDashboardData'dan sonra tanımlanmalı
  const checkAuth = React.useCallback(async () => {
    try {
      setLoading(true);
      const workerId = await SecureStore.getItemAsync('workerId');
      const displayName = await SecureStore.getItemAsync('displayName');

      if (workerId) {
        setIsAuthenticated(true);
        setUserId(workerId);
        if (displayName) setUserName(displayName);

        // Backend'den profil bilgisini al
        try {
          const userResponse = await authFetch('/users/me');
          if (userResponse.ok) {
            const { user } = await userResponse.json();
            if (user) {
              // displayName öncelikli, yoksa name, yoksa email kullan
              const profileDisplayName = user.displayName || user.name || user.email || '';
              if (profileDisplayName) {
                setUserName(profileDisplayName);
                // SecureStore'a da kaydet
                await SecureStore.setItemAsync('displayName', profileDisplayName);
              }
            }
          }
        } catch (userErr) {
          console.warn('[Home] User profile fetch error:', userErr);
        }

        await loadDashboardData(workerId);

        try {
          const { status } = await Location.getForegroundPermissionsAsync();
          const granted = status === 'granted';
          setHasLocationPermission(granted);
          if (granted) {
            setHidePermissionBanner(true);
            try { await AsyncStorage.setItem('hide_permission_banner', '1'); } catch { }
          } else {
            const hidden = await AsyncStorage.getItem('hide_permission_banner');
            setHidePermissionBanner(hidden === '1');
          }
          setPermissionChecked(true);
        } catch (e) {
          console.warn('Location permission check failed:', e);
          setHasLocationPermission(false);
          setPermissionChecked(true);
        }
      } else {
        setIsAuthenticated(false);
        setLoading(false);
      }
    } catch (err) {
      console.error('Auth check failed:', err);
      setIsAuthenticated(false);
      setLoading(false);
    }
  }, [loadDashboardData]);

  const onRefresh = React.useCallback(async () => {
    setRefreshing(true);
    await loadDashboardData(userId);
    setRefreshing(false);
  }, [userId, loadDashboardData]);

  // Category definitions
  const categories = [
    { name: 'Genel', icon: 'document-text', color: '#06b6d4' },
    { name: 'Teknoloji', icon: 'hardware-chip', color: '#7c3aed' },
    { name: 'İş Dünyası', icon: 'business', color: '#10b981' },
    { name: 'Güvenlik', icon: 'shield-checkmark', color: '#ef4444' },
    { name: 'Verimlilik', icon: 'speedometer', color: '#f59e0b' },
    { name: 'Gizlilik', icon: 'lock-closed', color: '#3b82f6' },
    { name: 'Yönetim', icon: 'people', color: '#8b5cf6' },
    { name: 'Analiz', icon: 'analytics', color: '#ec4899' },
    { name: 'Kullanım', icon: 'phone-portrait', color: '#14b8a6' },
    { name: 'Hizmet', icon: 'headset', color: '#f97316' },
    { name: 'Sektör', icon: 'grid', color: '#6366f1' },
  ];

  // Fetch articles by category
  const fetchCategoryArticles = React.useCallback(async (categoryName: string) => {
    if (!isAuthenticated || categoryLoading[categoryName]) return;

    setCategoryLoading(prev => ({ ...prev, [categoryName]: true }));
    try {
      const response = await authFetch(`/articles?category=${encodeURIComponent(categoryName)}&limit=3`);
      if (response.ok) {
        const data = await response.json();
        let articlesList: Article[] = [];

        if (Array.isArray(data)) {
          articlesList = data;
        } else if (data.data && Array.isArray(data.data)) {
          articlesList = data.data;
        } else if (data.data && data.data.articles && Array.isArray(data.data.articles)) {
          articlesList = data.data.articles;
        } else if (data.articles && Array.isArray(data.articles)) {
          articlesList = data.articles;
        }

        setCategoryArticles(prev => ({
          ...prev,
          [categoryName]: articlesList.slice(0, 3)
        }));
      } else {
        setCategoryArticles(prev => ({
          ...prev,
          [categoryName]: []
        }));
      }
    } catch (error) {
      console.error(`Error fetching ${categoryName} articles:`, error);
      setCategoryArticles(prev => ({
        ...prev,
        [categoryName]: []
      }));
    } finally {
      setCategoryLoading(prev => ({ ...prev, [categoryName]: false }));
    }
  }, [isAuthenticated, categoryLoading]);

  // Fetch all category articles
  React.useEffect(() => {
    if (isAuthenticated) {
      categories.forEach(cat => {
        fetchCategoryArticles(cat.name);
      });
    }
  }, [isAuthenticated]);

  // Fetch general articles from backend
  React.useEffect(() => {
    const fetchArticles = async () => {
      if (!isAuthenticated) {
        setArticles([]);
        return;
      }
      try {
        const response = await authFetch('/articles?limit=3');
        if (response.ok) {
          const data = await response.json();
          let articlesList: Article[] = [];

          if (Array.isArray(data)) {
            articlesList = data;
          } else if (data.data && Array.isArray(data.data)) {
            articlesList = data.data;
          } else if (data.data && data.data.articles && Array.isArray(data.data.articles)) {
            articlesList = data.data.articles;
          } else if (data.articles && Array.isArray(data.articles)) {
            articlesList = data.articles;
          }

          if (articlesList.length > 0) {
            setArticles(articlesList.slice(0, 3));
          } else {
            setArticles([]);
          }
        } else {
          if (response.status !== 429) {
            console.warn('Articles fetch failed:', response.status);
          }
          setArticles([]);
        }
      } catch (error) {
        console.error('Error fetching articles:', error);
        setArticles([]);
      }
    };
    if (isAuthenticated) {
      fetchArticles();
    }
  }, [isAuthenticated]);

  // Fetch plans from backend
  React.useEffect(() => {
    const fetchPlans = async () => {
      if (!isAuthenticated) {
        setPlans([]);
        return;
      }
      try {
        try {
          const plansRes = await authFetch('/plans');

          if (plansRes.ok) {
            const plansData = await plansRes.json();
            console.log('[Home] Plans response:', plansData);

            if (plansData.success && Array.isArray(plansData.plans) && plansData.plans.length > 0) {
              setPlans(plansData.plans);
              setCurrentPlanId(plansData.currentPlan || 'free');
            } else if (Array.isArray(plansData.plans) && plansData.plans.length > 0) {
              setPlans(plansData.plans);
              setCurrentPlanId(plansData.currentPlan || 'free');
            } else {
              console.warn('[Home] Plans array empty or invalid');
            }
          } else {
            if (plansRes.status !== 429) {
              console.warn('[Home] Plans fetch failed:', plansRes.status);
              const errorText = await plansRes.text();
              console.warn('[Home] Error response:', errorText);
            }
          }
        } catch (fetchError) {
          console.error('[Home] Plans fetch error:', fetchError);
        }

        try {
          const subscriptionRes = await authFetch('/me/subscription');
          if (subscriptionRes.ok) {
            const subData = await subscriptionRes.json();
            if (subData?.subscription?.planId) {
              setCurrentPlanId(subData.subscription.planId);
            }
          }
        } catch (subError) {
          console.warn('[Home] Subscription fetch error:', subError);
        }
      } catch (error) {
        console.error('[Home] Error fetching plans:', error);
      }
    };
    fetchPlans();
  }, [isAuthenticated]);

  React.useEffect(() => {
    if (plans.length > 0) {
      setTimeout(() => {
        Animated.stagger(150, statsAnimRef.current.map((anim: Animated.Value) =>
          Animated.spring(anim, { toValue: 1, tension: 50, friction: 8, useNativeDriver: true })
        )).start();
      }, 200);
    }
  }, [plans.length]);

  const resetAnimations = React.useCallback(() => {
    // Blur sorununu önlemek için fadeAnim'i direkt 1'e set et, animasyon yapma
    fadeAnim.setValue(1);
    headerScale.setValue(1);
    statsAnimRef.current.forEach(anim => anim.setValue(1));

    // Sadece hafif bir spring animasyonu yap, opacity değiştirme
    Animated.parallel([
      Animated.spring(headerScale, { toValue: 1, tension: 50, friction: 7, useNativeDriver: true }),
      Animated.stagger(80, statsAnimRef.current.map((anim: Animated.Value) =>
        Animated.spring(anim, { toValue: 1, tension: 50, friction: 8, useNativeDriver: true })
      ))
    ]).start();
  }, [fadeAnim, headerScale]);

  React.useEffect(() => {
    const init = async () => {
      try {
        await checkAuth();

        // İlk yüklemede fadeAnim'i 1'e set et - blur sorununu önlemek için
        fadeAnim.setValue(1);
        resetAnimations();

        setTimeout(() => {
          if (plans.length > 0) {
            Animated.stagger(150, statsAnimRef.current.map((anim: Animated.Value) =>
              Animated.spring(anim, { toValue: 1, tension: 50, friction: 8, useNativeDriver: true })
            )).start();
          }
        }, 300);
      } catch (e) {
        console.error('Init error:', e);
      }
    };

    init();

    return () => { };
  }, [checkAuth, resetAnimations]);

  useFocusEffect(
    React.useCallback(() => {
      fadeAnim.setValue(1);
      resetAnimations();
      if (userId) {
        loadDashboardData(userId).catch(e => console.error('Dashboard refresh failed:', e));
      }
      (async () => {
        try {
          const { status } = await Location.getForegroundPermissionsAsync();
          const granted = status === 'granted';
          setHasLocationPermission(granted);
          if (granted) {
            setHidePermissionBanner(true);
            await AsyncStorage.setItem('hide_permission_banner', '1');
          } else {
            const hidden = await AsyncStorage.getItem('hide_permission_banner');
            setHidePermissionBanner(hidden === '1');
          }
        } catch { }
      })();
      return () => { };
    }, [resetAnimations, fadeAnim, userId, loadDashboardData])
  );


  // Auto-play slider
  React.useEffect(() => {
    if (!isAuthenticated && Platform.OS === 'ios') {
      if (autoPlayRef.current) clearInterval(autoPlayRef.current);
      autoPlayRef.current = setInterval(() => {
        setCurrentSlide((prev) => {
          const next = (prev + 1) % SLIDES.length;
          sliderRef.current?.scrollToIndex({ index: next, animated: true });
          return next;
        });
      }, 4000);
    }
    return () => {
      if (autoPlayRef.current) clearInterval(autoPlayRef.current);
    };
  }, [isAuthenticated]);

  // Load permission banner preference - sadece bir kez
  React.useEffect(() => {
    if (!permissionChecked) return;
    (async () => {
      try {
        const v = await AsyncStorage.getItem('hide_permission_banner');
        if (v === '1') {
          setHidePermissionBanner(true);
        } else if (!hasLocationPermission) {
          setHidePermissionBanner(false);
        }
      } catch { }
    })();
  }, [permissionChecked, hasLocationPermission]);

  // Check if onboarding should be shown
  React.useEffect(() => {
    (async () => {
      try {
        const seen = await AsyncStorage.getItem('onboardingSeen');
        if (!seen && isAuthenticated) {
          setTimeout(() => {
            setShowOnboarding(true);
          }, 1000);
        }
      } catch { }
    })();
  }, [isAuthenticated]);

  const handleOnboardingClose = React.useCallback(async () => {
    try {
      await AsyncStorage.setItem('onboardingSeen', 'true');
      setShowOnboarding(false);
    } catch { }
  }, []);

  // Global app data clear handler
  React.useEffect(() => {
    const sub = DeviceEventEmitter.addListener('app:dataCleared', () => {
      try {
        // Reset UI/auth state
        setIsAuthenticated(false);
        setUserId('');
        setUserName('Ekip Üyesi');
        setStats({ activeWorkers: 0, totalGroups: 0, todayDistance: 0, activeAlerts: 0 });

        // Cleanup socket
        if (socketRef.current) {
          try { socketRef.current.off(); socketRef.current.disconnect(); } catch { }
          socketRef.current = null;
        }
      } catch { }
    });
    return () => { sub.remove?.(); };
  }, []);

  // Realtime: listen for group deletion and refresh dashboard
  React.useEffect(() => {
    // Cleanup function - her zaman tanımlanmalı
    const cleanup = () => {
      if (socketRef.current) {
        try { socketRef.current.off(); socketRef.current.disconnect(); } catch { }
        socketRef.current = null;
      }
    };

    if (!isAuthenticated || !userId) {
      // cleanup existing socket if auth lost
      if (socketRef.current) {
        try { socketRef.current.off(); socketRef.current.disconnect(); } catch { }
        socketRef.current = null;
      }
      return cleanup;
    }

    const setup = async () => {
      try {
        // fetch active groups to know which rooms to join
        const res = await authFetch(`/groups/user/${userId}/active`);
        const groups = res.ok ? await res.json() : [];
        interface Group {
          id: string;
        }
        const groupIds: string[] = (groups || []).map((g: Group) => g.id);

        // Get token for Socket.IO authentication
        const token = await getToken();
        const s = io(API_BASE, {
          transports: ['websocket'],
          reconnection: true,
          reconnectionAttempts: 5,
          reconnectionDelay: 1000,
          reconnectionDelayMax: 5000,
          auth: token ? { token } : undefined,
          extraHeaders: token ? { Authorization: `Bearer ${token}` } : undefined
        });
        socketRef.current = s;

        const joinAll = () => {
          try { groupIds.forEach(id => s.emit('join_group', id)); } catch { }
        };

        s.on('connect', joinAll);
        s.on('reconnect', joinAll);
        s.on('group_deleted', (ev: { groupId: string }) => {
          try {
            if (!ev || !ev.groupId) return;
            // Refresh stats
            onRefresh();
            showWarning('Bir grup silindi. Gösterge paneli güncellendi.');
          } catch { }
        });

        s.on('connect_error', () => {/* ignore */ });
      } catch (e) {
        // ignore
      }
    };

    setup();

    return cleanup;
  }, [isAuthenticated, userId, onRefresh, showWarning]);

  const handleQuickAction = (route: string) => {
    Animated.sequence([
      Animated.timing(cardScale, { toValue: 0.96, duration: 90, useNativeDriver: true }),
      Animated.timing(cardScale, { toValue: 1, duration: 120, useNativeDriver: true }),
    ]).start();
    router.push(route as any);
  };

  const closeLightbox = () => {
    Animated.timing(lightboxScale, { toValue: 0, duration: 200, useNativeDriver: true }).start(() => {
      setShowLightbox(false);
      setLightboxImage(null);
    });
  };

  const requestLocationPermission = async () => {
    try {
      const { status } = await Location.requestForegroundPermissionsAsync();
      const granted = status === 'granted';
      setHasLocationPermission(granted);
      if (granted) {
        showSuccess('Konum izni verildi');
        setHidePermissionBanner(true);
        setPermissionChecked(true);
        try {
          await AsyncStorage.setItem('hide_permission_banner', '1');
          await AsyncStorage.setItem('location_permission_granted', '1');
        } catch { }
      } else {
        showError('Konum izni verilmedi');
      }
    } catch (e) {
      console.error('Request location permission error:', e);
      showError('Konum izni alınamadı');
    }
  };

  const formatTimeAgo = (timestamp: number | null | undefined) => {
    if (!timestamp) return 'Yeni';
    const s = Math.floor((Date.now() - timestamp) / 1000);
    if (s < 0) return 'Yeni';
    if (s === 0 || s === 1) return '1 saniye önce';
    if (s < 60) return `${s} saniye önce`;
    const m = Math.floor(s / 60);
    if (m === 1) return '1 dakika önce';
    if (m < 60) return `${m} dakika önce`;
    const h = Math.floor(m / 60);
    if (h === 1) return '1 saat önce';
    if (h < 24) return `${h} saat önce`;
    const d = Math.floor(h / 24);
    if (d === 1) return '1 gün önce';
    return `${d} gün önce`;
  };

  // --- slider render ---
  const renderSlide = ({ item, index }: { item: Slide; index: number }) => {
    const inputRange = [(index - 1) * width, index * width, (index + 1) * width];
    const scale = slideX.interpolate({ inputRange, outputRange: [0.9, 1, 0.9], extrapolate: 'clamp' });
    const opacity = slideX.interpolate({ inputRange, outputRange: [0.6, 1, 0.6], extrapolate: 'clamp' });

    return (
      <Animated.View style={[styles.slideCard, { width, transform: [{ scale }], opacity }]}>
        <View style={[styles.slideBadge, { backgroundColor: `${item.color}15` }]}>
          <Ionicons name={item.icon as any} size={36} color={item.color} />
        </View>
        <Text style={styles.slideTitle}>{item.title}</Text>
        <Text style={styles.slideDesc}>{item.description}</Text>
        <Pressable style={[styles.slideCTA]} onPress={() => router.push('/help' as any)} android_ripple={{ color: 'rgba(255,255,255,0.25)' }}>
          <Text style={styles.slideCTAText}>Kısa Tur</Text>
          <Ionicons name="play" size={16} color="#06b6d4" />
        </Pressable>
      </Animated.View>
    );
  };

  // --- Activity item ---
  const ActivityItem: React.FC<{ item: RecentActivity; index: number }> = ({ item, index }) => {
    // TÜM HOOKS'LAR ERKEN RETURN'DEN ÖNCE
    const animValue = React.useMemo(() => {
      if (!activityAnimRef.current[index]) {
        activityAnimRef.current[index] = new Animated.Value(0);
      }
      return activityAnimRef.current[index];
    }, [index]);

    React.useEffect(() => {
      Animated.spring(animValue, {
        toValue: 1,
        tension: 50,
        friction: 8,
        useNativeDriver: true,
        delay: index * 80
      }).start();
    }, [animValue, index]);

    const handlePress = async () => {
      try {
        const meta: any = (item as any).metadata || {};
        // Priority: open external link if provided
        if (meta.link) {
          Linking.openURL(meta.link);
          return;
        }

        // If backendUrl provided, open it
        if (meta.backendUrl) {
          Linking.openURL(meta.backendUrl);
          return;
        }

        // If a file path is provided, offer to copy or attempt to open via vscode protocol
        if (meta.filePath) {
          // Try vscode protocol first (may not work on device).
          const vscodeUri = `vscode://file/${meta.filePath}`;
          const canOpen = await Linking.canOpenURL(vscodeUri);
          if (canOpen) {
            Linking.openURL(vscodeUri);
            return;
          }
          // Fallback: copy to clipboard and inform user
          Clipboard.setString(meta.filePath);
          showSuccess('Dosya yolu panoya kopyalandı');
          return;
        }

        // Default: show details
        showInfo(item.message || 'Detay yok');
      } catch (e) {
        console.warn('Activity press error', e);
      }
    };

    return (
      <Animated.View
        style={[
          styles.activityRow,
          {
            opacity: animValue,
            transform: [
              {
                translateX: animValue.interpolate({
                  inputRange: [0, 1],
                  outputRange: [-30, 0]
                })
              },
              {
                scale: animValue.interpolate({
                  inputRange: [0, 1],
                  outputRange: [0.95, 1]
                })
              }
            ]
          }
        ]}
      >
        <Pressable onPress={handlePress} android_ripple={{ color: 'rgba(255,255,255,0.03)' }} style={{ flexDirection: 'row', alignItems: 'center', flex: 1 }}>
          <Animated.View
            style={[
              styles.activityCircle,
              { backgroundColor: getActivityColor(item.type) + '20' },
              {
                transform: [
                  {
                    scale: animValue.interpolate({
                      inputRange: [0, 1],
                      outputRange: [0, 1]
                    })
                  }
                ]
              }
            ]}
          >
            <Ionicons name={getActivityIcon(item.type) as any} size={18} color={getActivityColor(item.type)} />
          </Animated.View>
          <View style={{ flex: 1, marginLeft: 6 }}>
            <Text style={styles.activityMsg}>{item.message}</Text>
            <View style={{ flexDirection: 'row', alignItems: 'center', justifyContent: 'space-between' }}>
              <Text style={styles.activityTime}>{formatTimeAgo(item.timestamp)}</Text>
              <View style={{ flexDirection: 'row', alignItems: 'center', gap: 8 }}>
                {((item as any).metadata?.backend) && (
                  <View style={[styles.sectionBadge, { paddingHorizontal: 8, paddingVertical: 4, marginLeft: 8 }]}>
                    <Text style={[styles.sectionBadgeText, { fontSize: 11 }]}>{((item as any).metadata.backend).toUpperCase()}</Text>
                  </View>
                )}
                {((item as any).metadata?.filePath) && (
                  <Text style={{ color: '#94a3b8', fontSize: 12 }}>{String((item as any).metadata.filePath).split('/').pop()}</Text>
                )}
                {(((item as any).metadata?.link) || ((item as any).metadata?.backendUrl) || ((item as any).metadata?.filePath)) && (
                  <Ionicons name="chevron-forward" size={16} color="#64748b" />
                )}
              </View>
            </View>
          </View>
        </Pressable>
      </Animated.View>
    );
  };

  const getActivityIcon = (type: RecentActivity['type']) => {
    switch (type) {
      case 'location': return 'navigate';
      case 'join': return 'person-add';
      case 'alert': return 'warning';
      default: return 'information-circle';
    }
  };

  const getActivityColor = (type: RecentActivity['type']) => {
    switch (type) {
      case 'location': return '#06b6d4';
      case 'join': return '#10b981';
      case 'alert': return '#f59e0b';
      default: return '#64748b';
    }
  };

  // --- Loading State ---
  if (loading && !isAuthenticated) {
    return (
      <SafeAreaView style={styles.container} edges={['top']}>
        <StatusBar barStyle="light-content" />
        <LoadingState fullScreen message="Yükleniyor..." />
      </SafeAreaView>
    );
  }

  // --- Authenticated UI ---
  return (
    <View style={{ flex: 1 }}>
      <LinearGradient colors={['#020617', '#0f172a', '#0f172a']} style={StyleSheet.absoluteFill} start={{ x: 0, y: 0 }} end={{ x: 1, y: 1 }} />
      <SafeAreaView style={styles.container} edges={['top']}>
        <StatusBar barStyle="light-content" />

        <UnifiedHeader
          title="Ana Sayfa"
          subtitle={`Hoş Geldin, ${userName}`}
          gradientColors={['#0891b2', '#06b6d4']}
          brandLabel="BAVAXE PLATFORMU"
          profileName={userName}
          showProfile={true}
          showNetwork={true}
          actions={
            <View style={{ flexDirection: 'row', gap: 8 }}>
              <Pressable
                onPress={() => router.push('/blog')}
                style={({ pressed }) => [
                  styles.headerIconButton,
                  pressed && styles.headerIconButtonPressed
                ]}
              >
                <Ionicons name="book-outline" size={20} color="#fff" />
              </Pressable>
              <Pressable
                onPress={async () => {
                  try {
                    if (!hasLocationPermission) {
                      const { status } = await Location.requestForegroundPermissionsAsync();
                      if (status !== 'granted') {
                        showError('Konum izni gerekli');
                        return;
                      }
                      setHasLocationPermission(true);
                    }

                    showInfo('Konum alınıyor...');
                    const location = await Location.getCurrentPositionAsync({
                      accuracy: Location.Accuracy.High
                    });

                    await shareCurrentLocation(
                      async () => ({ latitude: location.coords.latitude, longitude: location.coords.longitude }),
                      userName || 'Konumum',
                      () => showSuccess('Konum başarıyla paylaşıldı!'),
                      (error: string) => showError(error)
                    );
                  } catch (e: any) {
                    console.error('[Home] Share location error:', e);
                    if (e.code === 'E_LOCATION_UNAVAILABLE') {
                      showError('Konum servisleri kapalı. Lütfen ayarlardan açın.');
                    } else if (e.code === 'E_LOCATION_TIMEOUT') {
                      showError('Konum alınamadı. Lütfen tekrar deneyin.');
                    } else {
                      showError('Konum alınamadı: ' + (e.message || 'Bilinmeyen hata'));
                    }
                  }
                }}
                style={({ pressed }) => [
                  styles.headerIconButton,
                  pressed && styles.headerIconButtonPressed
                ]}
              >
                <Ionicons name="share-social-outline" size={20} color="#fff" />
              </Pressable>
            </View>
          }
        />

        <Animated.ScrollView
          contentContainerStyle={styles.scrollContent}
          style={{ opacity: fadeAnim }}
          refreshControl={
            <RefreshControl
              refreshing={refreshing}
              onRefresh={onRefresh}
              tintColor="#06b6d4"
              colors={['#06b6d4']}
            />
          }
        >
          {/* Slider at top */}
          <View style={styles.topSlider}>
            <Animated.FlatList
              ref={sliderRef}
              data={SLIDES}
              horizontal
              keyExtractor={(i) => i.id}
              pagingEnabled
              snapToInterval={width}
              decelerationRate="fast"
              showsHorizontalScrollIndicator={false}
              onScroll={Animated.event([{ nativeEvent: { contentOffset: { x: slideX } } }], { useNativeDriver: false })}
              onMomentumScrollEnd={(e) => {
                const idx = Math.round(e.nativeEvent.contentOffset.x / width);
                setCurrentSlide(idx);
              }}
              renderItem={renderSlide}
            />
            <View style={styles.dotsRow}>
              {SLIDES.map((_, i) => (
                <View key={i} style={[styles.smallDot, currentSlide === i && styles.smallDotActive]} />
              ))}
            </View>
          </View>

          {/* Permission banner */}
          {!hasLocationPermission && !hidePermissionBanner && permissionChecked && (
            <View style={styles.permissionBanner}>
              <Ionicons name="location-outline" size={24} color="#f59e0b" />
              <View style={{ flex: 1, marginLeft: 12 }}>
                <Text style={styles.permissionTitle}>Konum İzni Gerekli</Text>
                <Text style={styles.permissionText}>Takip özelliğini kullanmak için konum izni verin</Text>
              </View>
              <Pressable onPress={requestLocationPermission} style={styles.permissionButton} android_ripple={{ color: 'rgba(6,182,212,0.25)' }}><Text style={styles.permissionButtonText}>İzin Ver</Text></Pressable>
              <Pressable
                onPress={async () => {
                  try {
                    await AsyncStorage.setItem('hide_permission_banner', '1');
                    setHidePermissionBanner(true);
                  } catch { }
                }}
                style={{ marginLeft: 8, paddingHorizontal: 10, paddingVertical: 6 }}
                android_ripple={{ color: 'rgba(255,255,255,0.15)' }}
              >
                <Text style={{ color: '#64748b', fontWeight: '700' }}>Gizle</Text>
              </Pressable>
            </View>
          )}

          {/* Stats */}
          <View style={styles.statsContainer}>
            <View style={styles.statsGrid}>
              {[
                { icon: 'footsteps', value: stepData.steps.toLocaleString(), label: 'Adım', color: '#14b8a6', gradient: ['#14b8a6', '#0d9488'] as [string, string], route: '/(tabs)/steps', hasProgress: true, progress: stepData.progress, goal: stepData.goal },
                { icon: 'people', value: stats.activeWorkers, label: 'Aktif İşçi', color: '#06b6d4', gradient: ['#06b6d4', '#0891b2'] as [string, string] },
                { icon: 'albums', value: stats.totalGroups, label: 'Toplam Grup', color: '#7c3aed', gradient: ['#7c3aed', '#6d28d9'] as [string, string] },
                { icon: 'navigate', value: `${stats.todayDistance.toFixed(1)} km`, label: 'Bugün', color: '#10b981', gradient: ['#10b981', '#059669'] as [string, string] }
              ].map((stat, idx) => (
                <Pressable
                  key={idx}
                  onPress={() => {
                    if ((stat as any).route) {
                      router.push((stat as any).route as any);
                    }
                  }}
                  style={({ pressed }) => [
                    { opacity: pressed ? 0.9 : 1 }
                  ]}
                >
                  <Animated.View
                    style={[
                      styles.statCard,
                      {
                        opacity: statsAnimRef.current[idx] || new Animated.Value(0),
                        transform: [
                          {
                            scale: (statsAnimRef.current[idx] || new Animated.Value(0)).interpolate({
                              inputRange: [0, 1],
                              outputRange: [0.85, 1]
                            })
                          },
                          {
                            translateY: (statsAnimRef.current[idx] || new Animated.Value(0)).interpolate({
                              inputRange: [0, 1],
                              outputRange: [25, 0]
                            })
                          }
                        ]
                      }
                    ]}
                  >
                    <LinearGradient
                      colors={stat.gradient}
                      start={[0, 0]}
                      end={[1, 1]}
                      style={styles.statIconWrapper}
                    >
                      <Ionicons name={stat.icon as any} size={24} color="#fff" />
                    </LinearGradient>
                    <Text style={styles.statValue} numberOfLines={1}>{stat.value}</Text>
                    <Text style={styles.statLabel} numberOfLines={1}>{stat.label}</Text>
                    {(stat as any).hasProgress && (stat as any).goal && (
                      <View style={styles.statProgressContainer}>
                        <View style={styles.statProgressBar}>
                          <View
                            style={[
                              styles.statProgressFill,
                              {
                                width: `${((stat as any).progress * 100)}%`
                              }
                            ]}
                          />
                        </View>
                        <Text style={styles.statProgressText} numberOfLines={1}>
                          {Math.round((stat as any).progress * 100)}%
                        </Text>
                      </View>
                    )}
                  </Animated.View>
                </Pressable>
              ))}
            </View>
          </View>

          {/* Advanced Analytics */}
          {isAuthenticated && userId && (
            <View style={styles.section}>
              <AnalyticsCard userId={userId} dateRange="7d" />
            </View>
          )}


          {/* Quick actions - Professional Grid */}
          <View style={styles.section}>
            <View style={styles.sectionHeader}>
              <Text style={styles.sectionTitle}>Hızlı Erişim</Text>
              <View style={styles.sectionBadge}>
                <Ionicons name="flash" size={14} color="#06b6d4" />
                <Text style={styles.sectionBadgeText}>4</Text>
              </View>
            </View>
            <View style={styles.quickGrid}>
              {QUICK_ACTIONS.map((q, idx) => {
                const animValue = statsAnimRef.current[idx % 4] || new Animated.Value(0);

                return (
                  <Animated.View
                    key={q.id}
                    style={{
                      opacity: animValue,
                      transform: [
                        {
                          translateY: animValue.interpolate({
                            inputRange: [0, 1],
                            outputRange: [30, 0]
                          })
                        },
                        {
                          scale: animValue.interpolate({
                            inputRange: [0, 1],
                            outputRange: [0.9, 1]
                          })
                        }
                      ]
                    }}
                  >
                    <Pressable
                      onPress={() => handleQuickAction(q.route)}
                      style={({ pressed }) => [
                        styles.quickActionCard,
                        pressed && { opacity: 0.85, transform: [{ scale: 0.98 }] }
                      ]}
                      android_ripple={{ color: `${q.color}22` }}
                    >
                      <View style={[styles.quickActionIconWrapper, { backgroundColor: `${q.color}15` }]}>
                        <LinearGradient
                          colors={[q.color, q.color + 'DD']}
                          style={styles.quickActionIcon}
                          start={[0, 0]}
                          end={[1, 1]}
                        >
                          <Ionicons name={q.icon as any} size={26} color="#fff" />
                        </LinearGradient>
                      </View>
                      <View style={styles.quickActionContent}>
                        <Text style={styles.quickActionTitle}>{q.title}</Text>
                        <View style={styles.quickActionArrow}>
                          <Ionicons name="arrow-forward" size={16} color="#64748b" />
                        </View>
                      </View>
                    </Pressable>
                  </Animated.View>
                );
              })}
            </View>
          </View>

          {/* Premium Plans Section - Professional Design */}
          {isAuthenticated && (
            <View style={styles.section}>
              <View style={styles.sectionHeader}>
                <View style={{ flexDirection: 'row', alignItems: 'center', gap: 10 }}>
                  <LinearGradient
                    colors={['#7c3aed', '#a855f7']}
                    style={styles.plansIconWrapper}
                  >
                    <Ionicons name="rocket" size={22} color="#fff" />
                  </LinearGradient>
                  <View>
                    <Text style={styles.sectionTitle}>Premium Planlar</Text>
                    <Text style={styles.sectionSubtitle}>Ekibinizi profesyonelce yönetin</Text>
                  </View>
                </View>
                <Pressable
                  onPress={() => router.push('/UpgradeScreen' as any)}
                  style={styles.viewAllButton}
                  android_ripple={{ color: 'rgba(124,58,237,0.2)' }}
                >
                  <Text style={styles.viewAllText}>Tümünü Gör</Text>
                  <Ionicons name="arrow-forward" size={16} color="#7c3aed" />
                </Pressable>
              </View>

              {plans.length > 0 ? (
                <View style={styles.plansContainer}>
                  {plans.filter(p => p.id !== 'free').slice(0, 2).map((plan, idx) => {
                    const isCurrent = currentPlanId === plan.id;
                    const isRecommended = plan.recommended || plan.badge === 'Önerilen';
                    const planAnim = statsAnimRef.current[idx % 4] || new Animated.Value(0);

                    return (
                      <Animated.View
                        key={plan.id}
                        style={[
                          styles.planCard,
                          isRecommended && styles.planCardRecommended,
                          isCurrent && styles.planCardCurrent,
                          {
                            opacity: planAnim,
                            transform: [
                              {
                                translateY: planAnim.interpolate({
                                  inputRange: [0, 1],
                                  outputRange: [30, 0]
                                })
                              },
                              {
                                scale: planAnim.interpolate({
                                  inputRange: [0, 1],
                                  outputRange: [0.95, 1]
                                })
                              }
                            ]
                          }
                        ]}
                      >
                        {isRecommended && (
                          <View style={styles.planRecommendedBadge}>
                            <Ionicons name="star" size={12} color="#fff" />
                            <Text style={styles.planRecommendedText}>ÖNERİLEN</Text>
                          </View>
                        )}

                        {isCurrent && (
                          <View style={styles.planCurrentBadge}>
                            <Ionicons name="checkmark-circle" size={14} color="#10b981" />
                            <Text style={styles.planCurrentText}>Mevcut Plan</Text>
                          </View>
                        )}

                        <View style={styles.planHeader}>
                          <View style={styles.planTitleRow}>
                            <Text style={[styles.planTitle, isRecommended && styles.planTitleRecommended]}>
                              {plan.title}
                            </Text>
                            {plan.badge && !isRecommended && (
                              <View style={styles.planBadge}>
                                <Text style={styles.planBadgeText}>{plan.badge}</Text>
                              </View>
                            )}
                          </View>
                          <View style={styles.planPriceRow}>
                            <Text style={[styles.planPrice, isRecommended && styles.planPriceRecommended]}>
                              {plan.priceLabel}
                            </Text>
                            {plan.monthlyPriceTRY && plan.monthlyPriceTRY > 0 && (
                              <Text style={styles.planPriceTRY}>
                                {plan.monthlyPriceTRY} ₺ / ay
                              </Text>
                            )}
                          </View>
                        </View>

                        {plan.description && (
                          <Text style={[styles.planDescription, isRecommended && styles.planDescriptionRecommended]}>
                            {plan.description}
                          </Text>
                        )}

                        <View style={styles.planFeatures}>
                          {plan.features.slice(0, 3).map((feature: string, fIdx: number) => (
                            <View key={fIdx} style={styles.planFeatureRow}>
                              <Ionicons
                                name="checkmark-circle"
                                size={16}
                                color={isRecommended ? '#fff' : '#10b981'}
                              />
                              <Text style={[styles.planFeatureText, isRecommended && styles.planFeatureTextRecommended]}>
                                {feature}
                              </Text>
                            </View>
                          ))}
                          {plan.features.length > 3 && (
                            <Pressable
                              onPress={() => {
                                router.push({
                                  pathname: '/UpgradeScreen' as any,
                                  params: { planId: plan.id }
                                } as any);
                              }}
                              style={styles.planMoreButton}
                            >
                              <Text style={[styles.planMoreFeatures, isRecommended && styles.planMoreFeaturesRecommended]}>
                                +{plan.features.length - 3} özellik daha
                              </Text>
                              <Ionicons name="chevron-forward" size={14} color={isRecommended ? 'rgba(255,255,255,0.7)' : '#64748b'} />
                            </Pressable>
                          )}
                        </View>

                        {isCurrent ? (
                          <View style={styles.planCurrentButton}>
                            <Ionicons name="checkmark-circle" size={18} color="#10b981" />
                            <Text style={styles.planCurrentButtonText}>Aktif Plan</Text>
                          </View>
                        ) : (
                          <Pressable
                            style={[
                              styles.planUpgradeButton,
                              isRecommended && styles.planUpgradeButtonRecommended
                            ]}
                            onPress={() => {
                              router.push({
                                pathname: '/UpgradeScreen' as any,
                                params: { planId: plan.id }
                              } as any);
                            }}
                            android_ripple={{ color: isRecommended ? 'rgba(255,255,255,0.3)' : 'rgba(124,58,237,0.3)' }}
                          >
                            <Text style={[
                              styles.planUpgradeButtonText,
                              isRecommended && styles.planUpgradeButtonTextRecommended
                            ]}>
                              Ödeme Yap
                            </Text>
                            <Ionicons
                              name="card"
                              size={16}
                              color={isRecommended ? '#7c3aed' : '#fff'}
                            />
                          </Pressable>
                        )}
                      </Animated.View>
                    );
                  })}

                  {plans.filter(p => p.id !== 'free').length > 2 && (
                    <Pressable
                      style={styles.planViewAllCard}
                      onPress={() => router.push('/UpgradeScreen' as any)}
                      android_ripple={{ color: 'rgba(124,58,237,0.2)' }}
                    >
                      <LinearGradient
                        colors={['rgba(124,58,237,0.1)', 'rgba(168,85,247,0.1)']}
                        style={styles.planViewAllGradient}
                      >
                        <Ionicons name="grid-outline" size={24} color="#a855f7" />
                        <Text style={styles.planViewAllText}>Tüm Planları Gör</Text>
                        <Ionicons name="arrow-forward" size={18} color="#a855f7" />
                      </LinearGradient>
                    </Pressable>
                  )}
                </View>
              ) : null}
            </View>
          )}

          {/* Recent activities removed */}

          {/* Blog Layout */}
          <View style={styles.section}>
            <View style={styles.sectionHeader}>
              <View style={{ flexDirection: 'row', alignItems: 'center', gap: 12 }}>
                <View style={{
                  width: 40,
                  height: 40,
                  borderRadius: 12,
                  backgroundColor: 'rgba(6, 182, 212, 0.15)',
                  alignItems: 'center',
                  justifyContent: 'center',
                  borderWidth: 1,
                  borderColor: 'rgba(6, 182, 212, 0.3)',
                }}>
                  <Ionicons name="book" size={22} color="#06b6d4" />
                </View>
                <Text style={styles.sectionTitle}>Blog & Rehberler</Text>
              </View>
              <Pressable
                onPress={() => router.push('/blog' as any)}
                android_ripple={{ color: 'rgba(6, 182, 212, 0.15)' }}
                style={{
                  paddingHorizontal: 12,
                  paddingVertical: 6,
                  borderRadius: 12,
                  backgroundColor: 'rgba(6, 182, 212, 0.1)',
                }}
              >
                <Text style={styles.seeAllText}>Tümünü Gör →</Text>
              </Pressable>
            </View>
            {/* Show articles from backend */}
            {articles.length > 0 ? (
              articles.map((art, idx) => {
                const getCategoryIcon = (category?: string) => {
                  const icons: Record<string, string> = {
                    'Genel': 'document-text',
                    'Teknoloji': 'hardware-chip',
                    'İş Dünyası': 'business',
                    'Güvenlik': 'shield-checkmark',
                    'Verimlilik': 'speedometer',
                    'Gizlilik': 'lock-closed',
                    'Yönetim': 'people',
                    'Analiz': 'analytics',
                    'Kullanım': 'phone-portrait',
                    'Hizmet': 'headset',
                    'Sektör': 'grid',
                  };
                  return icons[category || ''] || 'document';
                };
                const getCategoryColor = (category?: string) => {
                  const colors: Record<string, string> = {
                    'Genel': '#06b6d4',
                    'Teknoloji': '#7c3aed',
                    'İş Dünyası': '#10b981',
                    'Güvenlik': '#ef4444',
                    'Verimlilik': '#f59e0b',
                    'Gizlilik': '#3b82f6',
                    'Yönetim': '#8b5cf6',
                    'Analiz': '#ec4899',
                    'Kullanım': '#14b8a6',
                    'Hizmet': '#f97316',
                    'Sektör': '#6366f1',
                  };
                  return colors[category || ''] || '#64748b';
                };
                const categoryColor = getCategoryColor((art as any).category);
                return (
                  <Pressable
                    key={`${art.id}-${idx}`}
                    style={styles.blogCard}
                    onPress={() => router.push(`/blog?id=${String(art.id)}` as any)}
                    android_ripple={{ color: 'rgba(255,255,255,0.12)' }}
                  >
                    <View style={styles.blogImageContainer}>
                      <LinearGradient colors={[categoryColor, `${categoryColor}CC`]} style={styles.blogImagePlaceholder}>
                        <Ionicons name={getCategoryIcon((art as any).category) as any} size={32} color="#fff" />
                      </LinearGradient>
                      {(art as any).category && (
                        <View style={[styles.blogBadge, { backgroundColor: `${categoryColor}40`, borderColor: `${categoryColor}60` }]}>
                          <Text style={[styles.blogBadgeText, { color: '#fff' }]}>{(art as any).category.toUpperCase()}</Text>
                        </View>
                      )}
                    </View>
                    <View style={styles.blogContent}>
                      <Text style={styles.blogTitle} numberOfLines={2}>{art.title}</Text>
                      <Text style={styles.blogExcerpt} numberOfLines={3}>{art.excerpt}</Text>
                      <View style={styles.blogMeta}>
                        <View style={styles.blogAuthor}>
                          <View style={styles.authorAvatar}>
                            <Ionicons name="person" size={14} color="#06b6d4" />
                          </View>
                          <Text style={styles.authorName}>Bavaxe</Text>
                        </View>
                        <View style={{ flexDirection: 'row', alignItems: 'center', gap: 8 }}>
                          <Ionicons name="time-outline" size={14} color="#64748b" />
                          <Text style={styles.blogReadTime}>{art.readTime || '5 dk'}</Text>
                          {(art as any).category && (
                            <>
                              <Text style={{ color: '#64748b', fontSize: 12 }}>•</Text>
                              <Text style={[styles.blogReadTime, { color: categoryColor }]}>
                                {(art as any).category}
                              </Text>
                            </>
                          )}
                        </View>
                      </View>
                    </View>
                  </Pressable>
                );
              })
            ) : (
              <View style={styles.emptyArticles}>
                <Ionicons name="document-text-outline" size={48} color="#64748b" />
                <Text style={styles.emptyArticlesText}>
                  {isAuthenticated ? 'Makaleler yükleniyor...' : 'Giriş yaparak makalelere erişebilirsiniz'}
                </Text>
              </View>
            )}
          </View>

          {/* Category Blog Sections - Enhanced Professional Design */}
          {categories.map((category) => {
            const categoryArticlesList = categoryArticles[category.name] || [];
            const isLoading = categoryLoading[category.name];

            if (isLoading || categoryArticlesList.length === 0) {
              return null; // Don't show empty sections
            }

            return (
              <View key={category.name} style={styles.section}>
                <LinearGradient
                  colors={[`${category.color}10`, 'transparent']}
                  start={{ x: 0, y: 0 }}
                  end={{ x: 1, y: 1 }}
                  style={styles.categorySectionGradient}
                >
                  <View style={styles.sectionHeader}>
                    <View style={{ flexDirection: 'row', alignItems: 'center', gap: 12 }}>
                      <View style={[styles.categoryIconContainer, { backgroundColor: `${category.color}20` }]}>
                        <Ionicons name={category.icon as any} size={22} color={category.color} />
                      </View>
                      <View>
                        <Text style={[styles.sectionTitle, { color: category.color, fontSize: 20 }]}>
                          {category.name} Blog
                        </Text>
                        <Text style={styles.categorySubtitle}>
                          {categoryArticlesList.length} makale
                        </Text>
                      </View>
                    </View>
                    <Pressable
                      onPress={() => router.push(`/blog?category=${encodeURIComponent(category.name)}` as any)}
                      android_ripple={{ color: `${category.color}20` }}
                      style={[styles.categorySeeAllButton, { borderColor: `${category.color}40` }]}
                    >
                      <Text style={[styles.seeAllText, { color: category.color }]}>Tümünü Gör</Text>
                      <Ionicons name="arrow-forward" size={16} color={category.color} />
                    </Pressable>
                  </View>

                  <View style={styles.categoryBlogContainer}>
                    {categoryArticlesList.map((art, idx) => {
                      const categoryColor = category.color;
                      const getCategoryIcon = (catName: string) => {
                        const cat = categories.find(c => c.name === catName);
                        return cat?.icon || 'document';
                      };

                      return (
                        <Pressable
                          key={`${category.name}-${art.id}-${idx}`}
                          style={[styles.categoryBlogCard, { borderLeftColor: categoryColor }]}
                          onPress={() => router.push(`/blog?id=${String(art.id)}` as any)}
                          android_ripple={{ color: `${categoryColor}15` }}
                        >
                          <View style={styles.categoryBlogContent}>
                            <View style={styles.categoryBlogHeader}>
                              <View style={[styles.categoryBlogIconContainer, { backgroundColor: `${categoryColor}15` }]}>
                                <Ionicons name={getCategoryIcon(category.name) as any} size={20} color={categoryColor} />
                              </View>
                              <View style={[styles.categoryBlogBadge, { backgroundColor: `${categoryColor}20` }]}>
                                <Text style={[styles.categoryBlogBadgeText, { color: categoryColor }]}>
                                  {category.name.toUpperCase()}
                                </Text>
                              </View>
                              {(art as any).featured && (
                                <View style={[styles.featuredBadge, { backgroundColor: '#f59e0b20' }]}>
                                  <Ionicons name="star" size={12} color="#f59e0b" />
                                  <Text style={styles.featuredBadgeText}>ÖNE ÇIKAN</Text>
                                </View>
                              )}
                            </View>
                            <Text style={styles.categoryBlogTitle} numberOfLines={2}>{art.title}</Text>
                            <Text style={styles.categoryBlogExcerpt} numberOfLines={2}>{art.excerpt}</Text>
                            <View style={styles.categoryBlogFooter}>
                              <View style={styles.categoryBlogMeta}>
                                <Ionicons name="time-outline" size={12} color="#64748b" />
                                <Text style={styles.categoryBlogReadTime}>{art.readTime || '5 dk'}</Text>
                                {(art as any).createdAt && (
                                  <>
                                    <Text style={styles.categoryBlogMetaSeparator}>•</Text>
                                    <Ionicons name="calendar-outline" size={12} color="#64748b" />
                                    <Text style={styles.categoryBlogReadTime}>
                                      {new Date((art as any).createdAt).toLocaleDateString('tr-TR', { day: 'numeric', month: 'short' })}
                                    </Text>
                                  </>
                                )}
                              </View>
                              <View style={[styles.categoryBlogArrow, { backgroundColor: `${categoryColor}15` }]}>
                                <Ionicons name="chevron-forward" size={16} color={categoryColor} />
                              </View>
                            </View>
                          </View>
                        </Pressable>
                      );
                    })}
                  </View>
                </LinearGradient>
              </View>
            );
          })}

          {/* Hakkımızda */}
          <View style={styles.section}>
            <View style={{ flexDirection: 'row', alignItems: 'center', gap: 10, marginBottom: 16 }}>
              <Ionicons name="information-circle" size={22} color="#06b6d4" />
              <Text style={styles.sectionTitle}>Hakkımızda</Text>
            </View>
            <View style={styles.infoCard}>
              <Text style={styles.infoText}>
                İşçi Takip Paneli, modern işletmelerin saha çalışanlarını güvenli ve verimli
                şekilde yönetmesini sağlayan bir teknoloji çözümüdür. 2024'ten beri binlerce
                işletmeye hizmet veriyoruz.
              </Text>
            </View>
          </View>

          {/* Hizmetler */}
          <View style={styles.section}>
            <View style={{ flexDirection: 'row', alignItems: 'center', gap: 10, marginBottom: 16 }}>
              <Ionicons name="rocket" size={22} color="#06b6d4" />
              <Text style={styles.sectionTitle}>Hizmetlerimiz</Text>
            </View>
            <View style={styles.servicesGrid}>
              <View style={styles.serviceCard}>
                <LinearGradient
                  colors={['#06b6d4', '#0891b2']}
                  style={styles.serviceIconWrapper}
                >
                  <Ionicons name="location" size={28} color="#fff" />
                </LinearGradient>
                <View style={styles.serviceContent}>
                  <Text style={styles.serviceTitle}>Canlı Takip</Text>
                  <Text style={styles.serviceDesc}>Gerçek zamanlı konum</Text>
                </View>
              </View>
              <View style={styles.serviceCard}>
                <LinearGradient
                  colors={['#7c3aed', '#6d28d9']}
                  style={styles.serviceIconWrapper}
                >
                  <Ionicons name="stats-chart" size={28} color="#fff" />
                </LinearGradient>
                <View style={styles.serviceContent}>
                  <Text style={styles.serviceTitle}>Raporlama</Text>
                  <Text style={styles.serviceDesc}>Detaylı analizler</Text>
                </View>
              </View>
              <View style={styles.serviceCard}>
                <LinearGradient
                  colors={['#10b981', '#059669']}
                  style={styles.serviceIconWrapper}
                >
                  <Ionicons name="people" size={28} color="#fff" />
                </LinearGradient>
                <View style={styles.serviceContent}>
                  <Text style={styles.serviceTitle}>Grup Yönetimi</Text>
                  <Text style={styles.serviceDesc}>Ekip organizasyonu</Text>
                </View>
              </View>
              <View style={styles.serviceCard}>
                <LinearGradient
                  colors={['#f59e0b', '#d97706']}
                  style={styles.serviceIconWrapper}
                >
                  <Ionicons name="shield-checkmark" size={28} color="#fff" />
                </LinearGradient>
                <View style={styles.serviceContent}>
                  <Text style={styles.serviceTitle}>Güvenlik</Text>
                  <Text style={styles.serviceDesc}>KVKK uyumlu</Text>
                </View>
              </View>
            </View>
          </View>

          {/* İletişim - Modern */}
          <View style={styles.section}>
            <View style={{ flexDirection: 'row', alignItems: 'center', gap: 10, marginBottom: 16 }}>
              <Ionicons name="chatbubbles" size={22} color="#06b6d4" />
              <Text style={styles.sectionTitle}>İletişim</Text>
            </View>

            <Pressable style={styles.modernContactCard} onPress={() => Linking.openURL('mailto:ozcanakbas38@gmail.com')} android_ripple={{ color: 'rgba(6,182,212,0.15)' }}>
              <LinearGradient
                colors={['#06b6d4', '#0891b2']}
                start={[0, 0]}
                end={[1, 1]}
                style={styles.modernContactIconWrapper}
              >
                <Ionicons name="mail" size={24} color="#fff" />
              </LinearGradient>
              <View style={styles.modernContactContent}>
                <Text style={styles.modernContactLabel}>E-posta</Text>
                <Text style={styles.modernContactValue}>ozcanakbas38@gmail.com</Text>
              </View>
              <View style={styles.modernContactArrow}>
                <Ionicons name="arrow-forward" size={18} color="#06b6d4" />
              </View>
            </Pressable>

            <Pressable style={styles.modernContactCard} onPress={() => Linking.openURL('https://wa.me/905327104355')} android_ripple={{ color: 'rgba(37,211,102,0.15)' }}>
              <LinearGradient
                colors={['#25D366', '#20BA5A']}
                start={[0, 0]}
                end={[1, 1]}
                style={styles.modernContactIconWrapper}
              >
                <Ionicons name="logo-whatsapp" size={24} color="#fff" />
              </LinearGradient>
              <View style={styles.modernContactContent}>
                <Text style={styles.modernContactLabel}>WhatsApp</Text>
                <Text style={styles.modernContactValue}>Hızlı Destek</Text>
              </View>
              <View style={styles.modernContactArrow}>
                <Ionicons name="arrow-forward" size={18} color="#25D366" />
              </View>
            </Pressable>
          </View>

          <Footer />
        </Animated.ScrollView>

        {/* Lightbox Modal */}
        <Modal visible={showLightbox} transparent animationType="fade" onRequestClose={closeLightbox}>
          <Pressable style={styles.lightboxOverlay} onPress={closeLightbox}>
            <Animated.View style={[styles.lightboxContent, { transform: [{ scale: lightboxScale }] }]}>
              {lightboxImage && (
                <Image source={{ uri: lightboxImage }} style={styles.lightboxImage} resizeMode="contain" />
              )}
              <Pressable style={styles.lightboxClose} onPress={closeLightbox}>
                <Ionicons name="close-circle" size={40} color="#fff" />
              </Pressable>
            </Animated.View>
          </Pressable>
        </Modal>

        <Toast
          message={toast.message}
          type={toast.type}
          visible={toast.visible}
          onHide={hideToast}
        />

        <OnboardingModal visible={showOnboarding} onClose={handleOnboardingClose} />
      </SafeAreaView >
    </View >
  );
}

const styles = StyleSheet.create({
  container: { flex: 1, backgroundColor: 'transparent' },
  loadingContainer: { flex: 1, alignItems: 'center', justifyContent: 'center', backgroundColor: 'transparent' },
  loadingText: { marginTop: 12, color: '#94a3b8' },

  // Header
  header: {
    paddingTop: Platform.OS === 'android' ? StatusBar.currentHeight ?? 24 : 24,
    paddingHorizontal: 24,
    paddingBottom: 32,
    borderBottomLeftRadius: 36,
    borderBottomRightRadius: 36,
  },
  headerTop: { flexDirection: 'row', justifyContent: 'space-between', alignItems: 'center' },
  headerLeft: { flexDirection: 'row', alignItems: 'center', flex: 1, gap: 14 },
  headerTextBlock: { flex: 1 },
  brandLabel: {
    fontSize: 11,
    color: 'rgba(255,255,255,0.9)',
    letterSpacing: 2,
    textTransform: 'uppercase',
    fontFamily: 'Poppins-ExtraBold',
    marginBottom: 4,
    textShadowColor: 'rgba(0, 0, 0, 0.1)',
    textShadowOffset: { width: 0, height: 1 },
    textShadowRadius: 2,
  },
  headerLogoContainer: {
    width: 56,
    height: 56,
    borderRadius: 18,
    alignItems: 'center',
    justifyContent: 'center',
    marginRight: 16,
    backgroundColor: 'rgba(255,255,255,0.15)',
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.25)',
    overflow: 'hidden',
  },
  headerTitle: {
    fontSize: 28,
    fontWeight: '900',
    color: '#fff',
    letterSpacing: 0.5,
    fontFamily: 'Poppins-Bold',
    lineHeight: 34,
  },
  headerSubtitle: {
    fontSize: 15,
    color: '#f0f9ff',
    marginTop: 2,
    fontWeight: '600',
    fontFamily: 'Poppins-Medium',
    opacity: 0.95,
    letterSpacing: 0.2
  },
  headerActions: { flexDirection: 'row', alignItems: 'center', gap: 10 },
  headerIconButton: {
    width: 46,
    height: 46,
    borderRadius: 16,
    backgroundColor: 'rgba(255,255,255,0.1)',
    alignItems: 'center',
    justifyContent: 'center',
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.2)',
  },
  headerIconButtonPressed: {
    backgroundColor: 'rgba(255,255,255,0.2)',
    transform: [{ scale: 0.96 }],
  },
  headerIconButtonDisabled: { opacity: 0.5 },
  headerIconButtonSettings: {
    backgroundColor: 'rgba(255, 255, 255, 0.15)',
    borderColor: 'rgba(255, 255, 255, 0.3)',
  },

  // Scroll
  scrollContent: { paddingBottom: 40 },

  // Top Slider
  topSlider: { marginBottom: 32, marginTop: 10 },

  // Auth header
  authHeader: { alignItems: 'center', paddingTop: 60, paddingBottom: 36, paddingHorizontal: 20, borderBottomLeftRadius: 32, borderBottomRightRadius: 32 },
  logoContainer: {
    width: 120,
    height: 120,
    borderRadius: 30,
    alignItems: 'center',
    justifyContent: 'center',
    marginBottom: 16,
    backgroundColor: 'rgba(255,255,255,0.05)',
  },
  logoTextBig: { fontSize: 28, fontWeight: '900', color: '#06b6d4', letterSpacing: 1 },
  authTitle: { fontSize: 26, color: '#fff', fontWeight: '900' },
  authSubtitle: { fontSize: 14, color: '#94a3b8', marginTop: 6 },
  authScrollView: { flex: 1 },

  // Slider
  sliderWrapper: { marginTop: 18, marginBottom: 16 },
  slideCard: {
    backgroundColor: 'rgba(30, 41, 59, 0.4)',
    marginHorizontal: 0,
    borderRadius: 28,
    padding: 32,
    alignItems: 'flex-start',
    justifyContent: 'center',
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.05)',
  },
  slideBadge: {
    width: 80,
    height: 80,
    borderRadius: 24,
    alignItems: 'center',
    justifyContent: 'center',
    marginBottom: 20,
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.1)',
  },
  slideTitle: { fontSize: 28, fontWeight: '900', color: '#fff', marginBottom: 12, letterSpacing: 0.5, fontFamily: 'Poppins-Bold' },
  slideDesc: { color: '#cbd5e1', fontSize: 16, lineHeight: 26, fontFamily: 'Poppins-Regular' },
  slideCTA: { marginTop: 24, flexDirection: 'row', alignItems: 'center', gap: 10, backgroundColor: 'rgba(6, 182, 212, 0.15)', paddingHorizontal: 24, paddingVertical: 14, borderRadius: 16, borderWidth: 1, borderColor: 'rgba(6, 182, 212, 0.3)' },
  slideCTAText: { color: '#06b6d4', fontWeight: '800', marginRight: 8, fontFamily: 'Poppins-Bold' },
  dotsRow: { flexDirection: 'row', justifyContent: 'center', marginTop: 24, paddingHorizontal: 20 },
  smallDot: { width: 6, height: 6, borderRadius: 3, backgroundColor: 'rgba(255,255,255,0.1)', marginHorizontal: 4 },
  smallDotActive: { width: 32, backgroundColor: '#06b6d4' },

  // About
  aboutCard: { backgroundColor: 'rgba(255,255,255,0.03)', borderRadius: 20, padding: 24, marginTop: 8, marginBottom: 14, borderWidth: 1, borderColor: 'rgba(255,255,255,0.08)' },
  aboutTitle: { fontSize: 20, fontWeight: '900', color: '#fff', fontFamily: 'Poppins-Bold' },
  aboutText: { color: '#94a3b8', marginTop: 10, lineHeight: 24, fontFamily: 'Poppins-Regular' },
  authBtnRow: { flexDirection: 'row', gap: 12, marginTop: 20 },
  primaryBtn: { flex: 1, backgroundColor: '#06b6d4', paddingVertical: 16, borderRadius: 14, flexDirection: 'row', alignItems: 'center', justifyContent: 'center', gap: 8 },
  primaryBtnText: { color: '#fff', fontWeight: '800', fontFamily: 'Poppins-Bold' },
  ghostBtn: { flex: 1, borderWidth: 1, borderColor: 'rgba(6,182,212,0.5)', paddingVertical: 16, borderRadius: 14, alignItems: 'center', justifyContent: 'center' },
  ghostBtnText: { color: '#06b6d4', fontWeight: '800', fontFamily: 'Poppins-Bold' },

  // Articles
  articlesSection: { marginTop: 6, marginBottom: 18 },
  articleRow: { flexDirection: 'row', backgroundColor: 'rgba(255,255,255,0.03)', borderRadius: 16, padding: 14, marginBottom: 12, alignItems: 'center', borderWidth: 1, borderColor: 'rgba(255,255,255,0.06)' },
  articleLeft: { width: 48, height: 48, borderRadius: 14, backgroundColor: 'rgba(6, 182, 212, 0.1)', alignItems: 'center', justifyContent: 'center', marginRight: 14 },
  articleTitle: { fontWeight: '800', color: '#fff', fontSize: 15, fontFamily: 'Poppins-Bold' },
  articleExcerpt: { color: '#94a3b8', marginTop: 4, fontFamily: 'Poppins-Regular', fontSize: 12 },
  articleMeta: { fontSize: 11, color: '#64748b', marginTop: 4, fontFamily: 'Poppins-Medium' },

  // Stats
  statsContainer: { marginBottom: 36, paddingHorizontal: 20 },
  statsGrid: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    justifyContent: 'space-between',
    gap: 16,
  },
  statCard: {
    width: (width - 40 - 16) / 2,
    backgroundColor: 'rgba(255, 255, 255, 0.03)', // Glass
    borderRadius: 24,
    paddingVertical: 24,
    paddingHorizontal: 16,
    alignItems: 'center',
    justifyContent: 'center',
    borderWidth: 1,
    borderColor: 'rgba(255, 255, 255, 0.08)',
    marginBottom: 0,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 10 },
    shadowOpacity: 0.2,
    shadowRadius: 20,
    elevation: 8,
  },
  statIconWrapper: {
    width: 52,
    height: 52,
    borderRadius: 18,
    alignItems: 'center',
    justifyContent: 'center',
    marginBottom: 14,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.2,
    shadowRadius: 8,
    elevation: 4,
  },
  statValue: {
    fontSize: 22,
    fontWeight: '900',
    color: '#fff',
    marginTop: 8,
    letterSpacing: 0.5,
    fontFamily: 'Poppins-Bold',
    textAlign: 'center',
  },
  statLabel: {
    color: '#64748b',
    marginTop: 4,
    fontSize: 13,
    fontWeight: '600',
    fontFamily: 'Poppins-Medium',
    textAlign: 'center',
  },
  statProgressContainer: { marginTop: 12, width: '100%', alignItems: 'center' },
  statProgressBar: { height: 4, borderRadius: 2, backgroundColor: 'rgba(255,255,255,0.05)', overflow: 'hidden', marginBottom: 6, width: '100%' },
  statProgressFill: { height: '100%', backgroundColor: '#06b6d4', borderRadius: 2 },
  statProgressText: { fontSize: 10, color: '#94a3b8', fontWeight: '700', fontFamily: 'Poppins-Bold' },

  // Quick Actions - Professional
  section: { marginBottom: 40, paddingHorizontal: 20 },
  sectionTitle: {
    fontSize: 22,
    fontWeight: '900',
    color: '#fff',
    letterSpacing: 0.5,
    fontFamily: 'Poppins-Bold',
    lineHeight: 30,
  },
  sectionBadge: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
    backgroundColor: 'rgba(6,182,212,0.15)',
    paddingHorizontal: 10,
    paddingVertical: 4,
    borderRadius: 10,
    borderWidth: 1,
    borderColor: 'rgba(6,182,212,0.2)',
  },
  sectionBadgeText: { fontSize: 12, fontWeight: '800', color: '#06b6d4', fontFamily: 'Poppins-ExtraBold' },
  quickGrid: { gap: 16 },
  quickActionCard: {
    backgroundColor: 'rgba(255, 255, 255, 0.03)',
    borderRadius: 24,
    padding: 20,
    flexDirection: 'row',
    alignItems: 'center',
    borderWidth: 1,
    borderColor: 'rgba(255, 255, 255, 0.06)',
    marginBottom: 0,
  },
  quickActionIconWrapper: {
    width: 64,
    height: 64,
    borderRadius: 16,
    alignItems: 'center',
    justifyContent: 'center',
    marginRight: 18,
  },
  quickActionIcon: {
    width: 48,
    height: 48,
    borderRadius: 12,
    alignItems: 'center',
    justifyContent: 'center',
  },
  quickActionContent: {
    flex: 1,
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
  },
  quickActionTitle: {
    fontSize: 18,
    fontWeight: '900',
    color: '#fff',
    letterSpacing: 0.3,
    fontFamily: 'Poppins-Bold',
  },
  quickActionArrow: {
    width: 32,
    height: 32,
    borderRadius: 10,
    backgroundColor: '#334155',
    alignItems: 'center',
    justifyContent: 'center',
  },

  // Activities
  activityRow: {
    flexDirection: 'row',
    alignItems: 'center',
    marginBottom: 16,
    backgroundColor: 'rgba(255,255,255,0.03)',
    borderRadius: 20,
    padding: 20,
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.06)',
  },
  activityCircle: { width: 56, height: 56, borderRadius: 20, alignItems: 'center', justifyContent: 'center', marginRight: 18 },
  activityMsg: { fontWeight: '900', color: '#fff', fontSize: 16, fontFamily: 'Poppins-Bold' },
  activityTime: { color: '#64748b', marginTop: 6, fontSize: 13, fontWeight: '600', fontFamily: 'Poppins-SemiBold' },

  emptyState: { alignItems: 'center', padding: 48, backgroundColor: 'rgba(255,255,255,0.03)', borderRadius: 20, borderWidth: 1, borderColor: 'rgba(255,255,255,0.06)' },
  emptyText: { color: '#64748b', marginTop: 16, fontSize: 15, fontFamily: 'Poppins-Regular' },

  // Error Banner
  errorBanner: { flexDirection: 'row', alignItems: 'center', backgroundColor: 'rgba(239, 68, 68, 0.1)', borderRadius: 20, padding: 20, marginBottom: 24, marginHorizontal: 20, borderWidth: 1, borderColor: 'rgba(239, 68, 68, 0.2)' },
  errorTitle: { fontSize: 15, fontWeight: '900', color: '#fff', marginBottom: 6, fontFamily: 'Poppins-Bold' },
  errorText: { fontSize: 13, color: '#fca5a5', fontFamily: 'Poppins-Regular' },

  // Permission
  permissionBanner: { flexDirection: 'row', alignItems: 'center', backgroundColor: 'rgba(245, 158, 11, 0.1)', borderRadius: 20, padding: 20, marginBottom: 24, marginHorizontal: 20, borderWidth: 1, borderColor: 'rgba(245, 158, 11, 0.2)' },
  permissionTitle: { fontSize: 15, fontWeight: '900', color: '#fff', marginBottom: 6, fontFamily: 'Poppins-Bold' },
  permissionText: { fontSize: 13, color: '#e2e8f0', fontFamily: 'Poppins-Regular' },
  permissionButton: { backgroundColor: '#f59e0b', paddingHorizontal: 16, paddingVertical: 10, borderRadius: 12 },
  permissionButtonText: { fontSize: 13, fontWeight: '900', color: '#fff', fontFamily: 'Poppins-Bold' },

  // Article Card (authenticated)
  articleCard: { flexDirection: 'row', backgroundColor: 'rgba(255,255,255,0.03)', borderRadius: 14, padding: 16, marginBottom: 12, alignItems: 'center', borderWidth: 1, borderColor: 'rgba(255,255,255,0.06)' },

  // Blog Layout
  sectionHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: 20,
    paddingHorizontal: 4,
  },
  seeAllText: {
    color: '#06b6d4',
    fontWeight: '900',
    fontSize: 15,
    fontFamily: 'Poppins-Bold',
    letterSpacing: 0.3,
  },
  blogCard: {
    backgroundColor: 'rgba(30, 41, 59, 0.4)',
    borderRadius: 24,
    marginBottom: 20,
    overflow: 'hidden',
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.08)',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 10 },
    shadowOpacity: 0.2,
    shadowRadius: 15,
    elevation: 8,
  },
  blogImageContainer: { position: 'relative', height: 200, overflow: 'hidden' },
  blogImagePlaceholder: { width: '100%', height: '100%', alignItems: 'center', justifyContent: 'center' },
  blogBadge: {
    position: 'absolute',
    top: 16,
    right: 16,
    paddingHorizontal: 14,
    paddingVertical: 8,
    borderRadius: 20,
    borderWidth: 1,
    borderColor: 'rgba(255, 255, 255, 0.2)',
  },
  blogBadgeText: {
    color: '#fff',
    fontSize: 11,
    fontWeight: '900',
    letterSpacing: 0.8,
    fontFamily: 'Poppins-Bold',
  },
  blogContent: { padding: 24, paddingTop: 20 },
  blogTitle: {
    fontSize: 22,
    fontWeight: '900',
    color: '#fff',
    marginBottom: 12,
    letterSpacing: -0.3,
    fontFamily: 'Poppins-ExtraBold',
    lineHeight: 30,
  },
  blogExcerpt: {
    fontSize: 15,
    color: '#cbd5e1',
    lineHeight: 24,
    marginBottom: 18,
    fontFamily: 'Poppins-Regular',
    letterSpacing: 0.1,
  },
  blogMeta: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    paddingTop: 16,
    borderTopWidth: 1,
    borderTopColor: 'rgba(148, 163, 184, 0.1)',
  },
  blogAuthor: { flexDirection: 'row', alignItems: 'center', gap: 10 },
  authorAvatar: {
    width: 32,
    height: 32,
    borderRadius: 16,
    backgroundColor: 'rgba(6, 182, 212, 0.15)',
    alignItems: 'center',
    justifyContent: 'center',
    borderWidth: 1,
    borderColor: 'rgba(6, 182, 212, 0.3)',
  },
  authorName: {
    fontSize: 13,
    fontWeight: '800',
    color: '#94a3b8',
    fontFamily: 'Poppins-ExtraBold',
    letterSpacing: 0.2,
  },
  blogReadTime: {
    fontSize: 13,
    color: '#64748b',
    fontFamily: 'Poppins-SemiBold',
    fontWeight: '600',
  },
  emptyArticles: {
    alignItems: 'center',
    justifyContent: 'center',
    paddingVertical: 60,
    paddingHorizontal: 20,
    backgroundColor: 'rgba(30, 41, 59, 0.3)',
    borderRadius: 20,
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.05)',
    borderStyle: 'dashed',
  },
  emptyArticlesText: {
    color: '#94a3b8',
    fontSize: 15,
    marginTop: 16,
    fontFamily: 'Poppins-Regular',
    textAlign: 'center',
    lineHeight: 22,
  },

  // Category Blog Styles
  categoryIconContainer: {
    width: 36,
    height: 36,
    borderRadius: 10,
    alignItems: 'center',
    justifyContent: 'center',
  },
  categoryBlogContainer: {
    gap: 16,
  },
  categoryBlogCard: {
    backgroundColor: '#1e293b',
    borderRadius: 20,
    borderLeftWidth: 4,
    overflow: 'hidden',
    borderWidth: 1,
    borderColor: '#334155',
    borderRightWidth: 1,
    borderTopWidth: 1,
    borderBottomWidth: 1,
  },
  categoryBlogContent: {
    padding: 20,
  },
  categoryBlogHeader: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    marginBottom: 12,
  },
  categoryBlogIconContainer: {
    width: 32,
    height: 32,
    borderRadius: 8,
    alignItems: 'center',
    justifyContent: 'center',
  },
  categoryBlogBadge: {
    paddingHorizontal: 10,
    paddingVertical: 4,
    borderRadius: 12,
  },
  categoryBlogBadgeText: {
    fontSize: 10,
    fontWeight: '800',
    letterSpacing: 0.5,
    fontFamily: 'Poppins-ExtraBold',
  },
  categoryBlogTitle: {
    fontSize: 18,
    fontWeight: '800',
    color: '#fff',
    marginBottom: 8,
    lineHeight: 24,
    fontFamily: 'Poppins-Bold',
  },
  categoryBlogExcerpt: {
    fontSize: 14,
    color: '#94a3b8',
    lineHeight: 20,
    marginBottom: 12,
    fontFamily: 'Poppins-Regular',
  },
  categoryBlogFooter: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
  },
  categoryBlogMeta: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
  },
  categoryBlogReadTime: {
    fontSize: 12,
    color: '#64748b',
    fontFamily: 'Poppins-Regular',
  },
  categoryBlogMetaSeparator: {
    fontSize: 12,
    color: '#64748b',
    marginHorizontal: 6,
  },
  categoryBlogArrow: {
    width: 32,
    height: 32,
    borderRadius: 16,
    alignItems: 'center',
    justifyContent: 'center',
  },
  categorySectionGradient: {
    borderRadius: 24,
    padding: 20,
    marginBottom: 24,
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.06)',
    backgroundColor: 'rgba(255,255,255,0.01)',
  },
  categorySubtitle: {
    fontSize: 12,
    color: '#64748b',
    marginTop: 2,
    fontFamily: 'Poppins-Regular',
  },
  categorySeeAllButton: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
    paddingHorizontal: 14,
    paddingVertical: 8,
    borderRadius: 12,
    borderWidth: 1,
    backgroundColor: 'rgba(255,255,255,0.03)',
  },
  featuredBadge: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 4,
    paddingHorizontal: 8,
    paddingVertical: 4,
    borderRadius: 10,
  },
  featuredBadgeText: {
    fontSize: 9,
    fontWeight: '800',
    color: '#f59e0b',
    letterSpacing: 0.5,
    fontFamily: 'Poppins-ExtraBold',
  },

  // Lightbox
  lightboxOverlay: { flex: 1, backgroundColor: 'rgba(0,0,0,0.95)', alignItems: 'center', justifyContent: 'center', backdropFilter: 'blur(10px)' },
  lightboxContent: { width: '90%', height: '70%', backgroundColor: '#000', borderRadius: 24, overflow: 'hidden', position: 'relative', borderWidth: 1, borderColor: 'rgba(255,255,255,0.1)' },
  lightboxImage: { width: '100%', height: '100%' },
  lightboxClose: { position: 'absolute', top: 16, right: 16, zIndex: 10, backgroundColor: 'rgba(0,0,0,0.5)', borderRadius: 20 },

  // Info sections
  infoSection: {
    marginHorizontal: 20,
    marginBottom: 32,
    backgroundColor: 'rgba(255,255,255,0.03)',
    borderRadius: 24,
    padding: 28,
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.06)',
  },
  infoTitle: { fontSize: 24, fontWeight: '900', color: '#fff', marginBottom: 20, letterSpacing: 0.5 },
  infoCard: { backgroundColor: 'transparent', borderRadius: 0, padding: 0, marginBottom: 0, borderWidth: 0, borderColor: 'transparent' },
  infoText: { fontSize: 16, color: '#94a3b8', lineHeight: 28, fontFamily: 'Poppins-Regular' },

  // Services
  servicesSection: { marginHorizontal: 20, marginBottom: 32 },
  servicesGrid: { flexDirection: 'column', gap: 14 },
  serviceCard: {
    width: '100%',
    backgroundColor: 'rgba(255,255,255,0.03)',
    borderRadius: 24,
    padding: 24,
    marginBottom: 0,
    flexDirection: 'row',
    alignItems: 'center',
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.06)',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.1,
    shadowRadius: 12,
    elevation: 8,
  },
  serviceIconWrapper: {
    width: 64,
    height: 64,
    borderRadius: 20,
    alignItems: 'center',
    justifyContent: 'center',
    marginRight: 18,
  },
  serviceContent: {
    flex: 1,
  },
  serviceTitle: { fontSize: 18, fontWeight: '900', color: '#fff', textAlign: 'left', letterSpacing: 0.3, fontFamily: 'Poppins-Bold' },
  serviceDesc: { fontSize: 14, color: '#94a3b8', marginTop: 4, textAlign: 'left', fontFamily: 'Poppins-Regular' },

  // Contact - Modern Design
  contactSection: { marginHorizontal: 20, marginBottom: 40 },
  contactHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: 20,
  },
  contactHeaderLeft: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
  },
  contactHeaderIcon: {
    width: 48,
    height: 48,
    borderRadius: 16,
    backgroundColor: 'rgba(255,255,255,0.05)',
    alignItems: 'center',
    justifyContent: 'center',
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.08)',
  },
  contactHeaderTitle: {
    fontSize: 22,
    fontWeight: '900',
    color: '#fff',
    letterSpacing: 0.5,
  },
  contactHeaderSubtitle: {
    fontSize: 13,
    color: '#64748b',
    marginTop: 2,
    fontWeight: '600',
  },
  modernContactCard: {
    backgroundColor: 'rgba(255,255,255,0.03)',
    borderRadius: 22,
    padding: 22,
    marginBottom: 16,
    flexDirection: 'row',
    alignItems: 'center',
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.06)',
  },
  modernContactIconWrapper: {
    width: 60,
    height: 60,
    borderRadius: 20,
    alignItems: 'center',
    justifyContent: 'center',
    marginRight: 18,
  },
  modernContactContent: {
    flex: 1,
  },
  modernContactLabel: {
    fontSize: 12,
    color: '#64748b',
    fontWeight: '700',
    textTransform: 'uppercase',
    letterSpacing: 1,
    marginBottom: 4,
    fontFamily: 'Poppins-SemiBold',
  },
  modernContactValue: {
    fontSize: 16,
    color: '#fff',
    fontWeight: '800',
    fontFamily: 'Poppins-ExtraBold',
  },
  modernContactArrow: {
    width: 40,
    height: 40,
    borderRadius: 14,
    backgroundColor: 'rgba(255,255,255,0.05)',
    alignItems: 'center',
    justifyContent: 'center',
  },
  modernContactBadge: {
    paddingHorizontal: 12,
    paddingVertical: 6,
    borderRadius: 12,
  },
  modernContactBadgeText: {
    fontSize: 12,
    fontWeight: '900',
    letterSpacing: 0.5,
  },

  // Bionluk Card
  bionlukCard: {
    marginTop: 8,
    borderRadius: 24,
    overflow: 'hidden',
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.1)',
  },
  bionlukGradient: {
    padding: 24,
  },
  bionlukHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: 16,
  },
  bionlukIconWrapper: {
    width: 52,
    height: 52,
    borderRadius: 16,
    backgroundColor: '#fff',
    alignItems: 'center',
    justifyContent: 'center',
  },
  bionlukBadge: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
    backgroundColor: 'rgba(255,255,255,0.9)',
    paddingHorizontal: 12,
    paddingVertical: 6,
    borderRadius: 12,
  },
  bionlukBadgeText: {
    fontSize: 12,
    fontWeight: '900',
    color: '#0284c7',
    letterSpacing: 0.5,
  },
  bionlukTitle: {
    fontSize: 22,
    fontWeight: '900',
    color: '#fff',
    marginBottom: 8,
    letterSpacing: 0.3,
    textShadowColor: 'rgba(0,0,0,0.3)',
    textShadowOffset: { width: 0, height: 2 },
    textShadowRadius: 4,
  },
  bionlukDesc: {
    fontSize: 15,
    color: '#e0f2fe',
    lineHeight: 24,
    marginBottom: 20,
    fontWeight: '500',
  },
  bionlukFeatures: {
    flexDirection: 'row',
    flexWrap: 'wrap',
    gap: 12,
  },
  bionlukFeature: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
    backgroundColor: 'rgba(255,255,255,0.15)',
    paddingHorizontal: 14,
    paddingVertical: 8,
    borderRadius: 12,
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.2)',
  },
  bionlukFeatureText: {
    fontSize: 13,
    fontWeight: '800',
    color: '#fff',
  },

  // Premium Plans Styles
  plansIconWrapper: {
    width: 44,
    height: 44,
    borderRadius: 14,
    alignItems: 'center',
    justifyContent: 'center',
  },
  sectionSubtitle: {
    fontSize: 13,
    color: '#94a3b8',
    marginTop: 2,
    fontFamily: 'Poppins-Regular',
  },
  viewAllButton: {
    flexDirection: 'row',
    alignItems: 'center',
    marginLeft: 10,
    gap: 6,
    paddingHorizontal: 14,
    paddingVertical: 8,
    borderRadius: 12,
    backgroundColor: 'rgba(124,58,237,0.1)',
    borderWidth: 1,
    borderColor: 'rgba(124,58,237,0.2)',
  },
  viewAllText: {
    color: '#a855f7',
    fontSize: 13,
    fontWeight: '800',
    fontFamily: 'Poppins-Bold',
  },
  plansLoadingContainer: {
    alignItems: 'center',
    justifyContent: 'center',
    paddingVertical: 40,
    backgroundColor: 'rgba(255,255,255,0.03)',
    borderRadius: 20,
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.06)',
  },
  plansLoadingText: {
    color: '#94a3b8',
    marginTop: 12,
    fontSize: 14,
    fontFamily: 'Poppins-Regular',
  },
  plansContainer: {
    gap: 20,
  },
  planCard: {
    backgroundColor: 'rgba(30, 41, 59, 0.4)', // Glass
    borderRadius: 28,
    padding: 28,
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.08)',
    position: 'relative',
    overflow: 'visible',
  },
  planCardRecommended: {
    backgroundColor: 'rgba(124, 58, 237, 0.15)', // Glass purple
    borderColor: 'rgba(139, 92, 246, 0.4)',
    borderWidth: 1.5,
    shadowColor: '#8b5cf6',
    shadowOffset: { width: 0, height: 0 },
    shadowOpacity: 0.2,
    shadowRadius: 20,
  },
  planCardCurrent: {
    borderColor: '#10b981',
    borderWidth: 2,
    backgroundColor: 'rgba(16, 185, 129, 0.05)',
  },
  planRecommendedBadge: {
    position: 'absolute',
    top: -12,
    right: 24,
    flexDirection: 'row',
    alignItems: 'center',
    gap: 4,
    backgroundColor: '#f59e0b',
    paddingHorizontal: 14,
    paddingVertical: 6,
    borderRadius: 14,
    shadowColor: '#f59e0b',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.3,
    shadowRadius: 8,
    elevation: 6,
    zIndex: 10,
  },
  planRecommendedText: {
    color: '#fff',
    fontSize: 11,
    fontWeight: '900',
    letterSpacing: 0.5,
    fontFamily: 'Poppins-ExtraBold',
  },
  planCurrentBadge: {
    position: 'absolute',
    top: 20,
    left: 20,
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
    backgroundColor: 'rgba(16,185,129,0.15)',
    paddingHorizontal: 12,
    paddingVertical: 6,
    borderRadius: 12,
    borderWidth: 1,
    borderColor: '#10b981',
  },
  planCurrentText: {
    color: '#10b981',
    fontSize: 12,
    fontWeight: '800',
    fontFamily: 'Poppins-Bold',
  },
  planHeader: {
    marginBottom: 16,
    marginTop: 12,
  },
  planTitleRow: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    marginBottom: 8,
  },
  planTitle: {
    fontSize: 26,
    fontWeight: '900',
    color: '#fff',
    letterSpacing: 0.3,
    fontFamily: 'Poppins-Bold',
  },
  planTitleRecommended: {
    color: '#fff',
    textShadowColor: 'rgba(139, 92, 246, 0.5)',
    textShadowOffset: { width: 0, height: 0 },
    textShadowRadius: 10,
  },
  planBadge: {
    backgroundColor: 'rgba(124,58,237,0.2)',
    paddingHorizontal: 12,
    paddingVertical: 6,
    borderRadius: 10,
    borderWidth: 1,
    borderColor: 'rgba(124,58,237,0.3)',
  },
  planBadgeText: {
    color: '#a855f7',
    fontSize: 11,
    fontWeight: '800',
    fontFamily: 'Poppins-Bold',
  },
  planPriceRow: {
    flexDirection: 'row',
    alignItems: 'baseline',
    gap: 8,
  },
  planPrice: {
    fontSize: 36,
    fontWeight: '900',
    color: '#a855f7',
    letterSpacing: -1,
    fontFamily: 'Poppins-ExtraBold',
  },
  planPriceRecommended: {
    color: '#fff',
  },
  planPriceTRY: {
    fontSize: 15,
    color: '#94a3b8',
    fontWeight: '600',
    fontFamily: 'Poppins-SemiBold',
  },
  planDescription: {
    fontSize: 15,
    color: '#94a3b8',
    lineHeight: 24,
    marginBottom: 20,
    fontFamily: 'Poppins-Regular',
  },
  planDescriptionRecommended: {
    color: 'rgba(255,255,255,0.85)',
  },
  planFeatures: {
    gap: 12,
    marginBottom: 24,
  },
  planFeatureRow: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
  },
  planFeatureText: {
    color: '#e2e8f0',
    fontSize: 14,
    flex: 1,
    fontFamily: 'Poppins-Regular',
    lineHeight: 20,
  },
  planFeatureTextRecommended: {
    color: 'rgba(255,255,255,0.95)',
  },
  planMoreButton: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
    marginTop: 8,
    paddingVertical: 8,
    paddingHorizontal: 12,
    borderRadius: 8,
    backgroundColor: 'rgba(124,58,237,0.1)',
  },
  planMoreFeatures: {
    color: '#a855f7',
    fontSize: 13,
    fontWeight: '700',
    fontFamily: 'Poppins-Bold',
  },
  planMoreFeaturesRecommended: {
    color: 'rgba(255,255,255,0.9)',
  },
  planViewAllCard: {
    borderRadius: 24,
    overflow: 'hidden',
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.08)',
    backgroundColor: 'rgba(255,255,255,0.03)',
  },
  planViewAllGradient: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    gap: 10,
    padding: 24,
  },
  planViewAllText: {
    color: '#a855f7',
    fontSize: 16,
    fontWeight: '900',
    fontFamily: 'Poppins-ExtraBold',
  },
  planCurrentButton: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    gap: 8,
    paddingVertical: 16,
    backgroundColor: 'rgba(16,185,129,0.1)',
    borderRadius: 14,
    borderWidth: 1,
    borderColor: '#10b981',
  },
  planCurrentButtonText: {
    color: '#10b981',
    fontSize: 16,
    fontWeight: '800',
    fontFamily: 'Poppins-Bold',
  },
  planUpgradeButton: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    gap: 8,
    paddingVertical: 16,
    backgroundColor: '#7c3aed',
    borderRadius: 14,
    shadowColor: '#7c3aed',
    shadowOffset: { width: 0, height: 8 },
    shadowOpacity: 0.3,
    shadowRadius: 16,
    elevation: 8,
  },
  planUpgradeButtonRecommended: {
    backgroundColor: '#fff',
    shadowColor: '#fff',
    shadowOpacity: 0.15,
  },
  planUpgradeButtonText: {
    color: '#fff',
    fontSize: 16,
    fontWeight: '900',
    letterSpacing: 0.3,
    fontFamily: 'Poppins-ExtraBold',
  },
  planUpgradeButtonTextRecommended: {
    color: '#7c3aed',
  },
  plansEmptyContainer: {
    alignItems: 'center',
    justifyContent: 'center',
    paddingVertical: 40,
    backgroundColor: 'rgba(255,255,255,0.03)',
    borderRadius: 20,
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.06)',
    gap: 12,
  },
  plansEmptyText: {
    color: '#94a3b8',
    fontSize: 14,
    fontFamily: 'Poppins-Regular',
  },
  plansRetryButton: {
    marginTop: 8,
    paddingHorizontal: 20,
    paddingVertical: 10,
    backgroundColor: '#7c3aed',
    borderRadius: 10,
  },
  plansRetryText: {
    color: '#fff',
    fontSize: 14,
    fontWeight: '800',
    fontFamily: 'Poppins-Bold',
  },

  // Plan Modal Styles
  planModalOverlay: {
    flex: 1,
    backgroundColor: 'rgba(0,0,0,0.85)',
    justifyContent: 'flex-end',
    backdropFilter: 'blur(10px)',
  },
  planModalContent: {
    backgroundColor: '#0f172a',
    borderTopLeftRadius: 32,
    borderTopRightRadius: 32,
    paddingTop: 28,
    paddingHorizontal: 28,
    paddingBottom: Platform.OS === 'ios' ? 44 : 28,
    maxHeight: '90%',
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.1)',
  },
  planModalHeader: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    marginBottom: 24,
  },
  planModalIconWrapper: {
    width: 64,
    height: 64,
    borderRadius: 20,
    alignItems: 'center',
    justifyContent: 'center',
    backgroundColor: 'rgba(255,255,255,0.05)',
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.1)',
  },
  planModalClose: {
    width: 44,
    height: 44,
    borderRadius: 22,
    backgroundColor: 'rgba(255,255,255,0.05)',
    alignItems: 'center',
    justifyContent: 'center',
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.1)',
  },
  planModalBody: {
    gap: 24,
  },
  planModalTitleRow: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
  },
  planModalTitle: {
    fontSize: 32,
    fontWeight: '900',
    color: '#fff',
    fontFamily: 'Poppins-Bold',
    letterSpacing: -0.5,
  },
  planModalRecommendedBadge: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 4,
    backgroundColor: '#f59e0b',
    paddingHorizontal: 12,
    paddingVertical: 6,
    borderRadius: 12,
    shadowColor: '#f59e0b',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.3,
    shadowRadius: 8,
    elevation: 4,
  },
  planModalRecommendedText: {
    color: '#fff',
    fontSize: 11,
    fontWeight: '900',
    fontFamily: 'Poppins-ExtraBold',
  },
  planModalPriceSection: {
    gap: 8,
  },
  planModalPrice: {
    fontSize: 42,
    fontWeight: '900',
    color: '#a855f7',
    fontFamily: 'Poppins-ExtraBold',
    letterSpacing: -1,
  },
  planModalPriceTRY: {
    fontSize: 16,
    color: '#94a3b8',
    fontWeight: '600',
    fontFamily: 'Poppins-SemiBold',
  },
  planModalDescription: {
    fontSize: 16,
    color: '#cbd5e1',
    lineHeight: 24,
    fontFamily: 'Poppins-Regular',
  },
  planModalFeaturesSection: {
    gap: 16,
    backgroundColor: 'rgba(255,255,255,0.03)',
    borderRadius: 24,
    padding: 24,
    borderWidth: 1,
    borderColor: 'rgba(255,255,255,0.06)',
  },
  planModalFeaturesTitle: {
    fontSize: 18,
    fontWeight: '800',
    color: '#fff',
    marginBottom: 8,
    fontFamily: 'Poppins-Bold',
  },
  planModalFeatureItem: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 14,
    paddingVertical: 4,
  },
  planModalFeatureText: {
    fontSize: 15,
    color: '#e2e8f0',
    flex: 1,
    fontFamily: 'Poppins-Regular',
    lineHeight: 22,
  },
  planModalFeatureTextRecommended: {
    color: 'rgba(255,255,255,0.95)',
  },
  planModalCurrentButton: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    gap: 10,
    paddingVertical: 18,
    backgroundColor: 'rgba(16,185,129,0.1)',
    borderRadius: 16,
    borderWidth: 1,
    borderColor: '#10b981',
    marginTop: 12,
  },
  planModalCurrentButtonText: {
    color: '#10b981',
    fontSize: 17,
    fontWeight: '800',
    fontFamily: 'Poppins-Bold',
  },
  planModalUpgradeButton: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    gap: 10,
    paddingVertical: 18,
    backgroundColor: '#7c3aed',
    borderRadius: 16,
    marginTop: 12,
    shadowColor: '#7c3aed',
    shadowOffset: { width: 0, height: 8 },
    shadowOpacity: 0.3,
    shadowRadius: 16,
    elevation: 8,
  },
  planModalUpgradeButtonRecommended: {
    backgroundColor: '#fff',
    shadowColor: '#fff',
    shadowOpacity: 0.15,
  },
  planModalUpgradeButtonText: {
    color: '#fff',
    fontSize: 18,
    fontWeight: '900',
    fontFamily: 'Poppins-ExtraBold',
  },
  planModalUpgradeButtonTextRecommended: {
    color: '#7c3aed',
  },
});
